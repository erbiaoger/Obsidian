# 使用分布式声学传感数据进行交通分析的深度反卷积

[TOC]

HAL是一个多学科开放存取档案，用于存放和传播科学研究文件，无论它们是否已出版。这些文件可能来自法国或国外的教学和研究机构，也可能来自公共或私人研究中心。
多学科开放档案 HAL 旨在存储和传播来自法国或外国教育和研究机构、公共或私人实验室的研究级科学文件，无论是否出版。

## 摘要

分布式声学传感 (DAS) 是一种新颖的振动传感技术，可用于检测车辆并使用现有的电信电缆分析交通流量。 因此，DAS 在未来“智慧城市”发展中具有巨大潜力，例如实时交通事件检测。尽管之前的研究已经考虑了在相对较轻的交通条件下进行车辆检测，但为了使 DAS 在现实世界场景中成为一种可行的技术，检测算法还需要在交通繁忙的条件下稳健地执行。在这项研究中，我们研究了路边 DAS 在同时检测和表征单个车辆的速度方面的潜力。 为了提高时间分辨率和检测精度，我们提出了一种自监督深度学习方法，该方法从 DAS 数据中对**特征汽车脉冲响应进行反卷积**，我们将其称为反卷积自动编码器 (DAE)。 我们表明，DAS 数据与我们的 DAE 的反卷积导致比原始（非反卷积）数据更好的时间分辨率和检测性能。我们随后将我们的 DAE 应用于 24 小时交通周期，证明了我们提出的方法处理大量 DAS 数据的可行性，可能是近乎实时的。

## 一、 介绍

分布式光纤传感是一种新兴技术，可以测量光纤电缆沿线特定位置的应变和/或温度。 简而言之，测量原理依赖于将光脉冲发送到光纤的一端，并分析在**沿光纤的纳米散射点散射后返回检测器的光**（参见 [1] 讨论）。 这些散射点是光纤生产过程的必然结果，因此任何市售的光纤电缆都可以进行传感。 使用干涉技术，对散射光的分析可以深入了解光纤的拉伸或沿光纤的固定传感点的温度变化。 因此，这项技术将光纤电缆转变为传感器阵列，并为工程、地球物理学和环境科学开辟了大量机会。 成功应用的例子包括结构完整性监测 [2]、井筒地震学 [3]-[5]、永久冻土和含水层监测 [6]、[7]，以及实验室岩石力学实验 [8]、[9]。
作为分布式光纤传感的一个子集，具有相位光时域的分布式声学传感 (DAS)  分发反射计（通常称为 Φ-OTDR）许可证 以米量级的空间分辨率测量几十公里距离上的应变（速率）。 与光频域反射计等对应技术不同，时间采样率可高达数 kHz，使其非常适合大规模地震实验——参见 [10] 和 [11] 以了解最近的技术和应用的详细评论 地震学中的 DAS。 虽然地震和其他地震事件（如主动源或采石场爆炸）是许多使用 DAS 进行地震研究的主要兴趣点，但同样考虑了其他地面振动源。 例如，在路边地震干涉测量研究 [12]-[14] 中，汽车已被分析为一种能源，而且还用于推断 COVID-19 锁定措施的影响 [15]，并检测交通流量 [16]，  [17]。

DAS 的一大优势是它可以利用现有的用于电信的光纤电缆，而不需要部署专用电缆。 这种利用现有光纤基础设施的能力极大地加快了城市地区“智能”应用程序的开发，这些应用程序通常具有密集的光纤电缆网络，例如实时交通流量监控。 虽然交通摄像头和气动管等现有技术可以对给定位置的车辆数量和/或速度进行点测量，但 DAS 可以在数公里的道路上每隔几米提供对经过车辆的测量。 此外，DAS 测量本质上是匿名的（与交通摄像机镜头相反），消除了隐私问题并避免了隐私法规。 因此，DAS 是未来城市规模交通分析应用的有力竞争者。

虽然人类分析师通常可以轻松地在 DAS 数据中发现汽车，但自动检测单个车辆并提取其速度更具挑战性。 已经提出了一些自动提取方法，当汽车在时间和空间上分离良好时效果很好（例如[16]，[18]），但是为了在人口稠密的城市地区进行稳健的交通分析，提取程序需要 能够处理繁忙的交通情况（例如，高峰时间），这反过来又要求所采用的方法具有很高的时空精度。 在这项研究中，我们详细介绍了一种自我监督的深度学习方法，该方法结合了车辆信号的先验知识，以实现高分辨率检测和速度估计性能。

简而言之，我们的模型可以描述为“反卷积自动编码器”，我们随后通过传统的波束成形技术对反卷积的 DAS 数据进行检测和速度估计。 我们的结果表明，分析的时间分辨率得到了提高，误报和漏检的次数减少了，同时训练和部署深度学习模型只需很少的努力。

本文组织如下：首先，我们在第二节中更详细地描述了 DAS 测量原理和汽车在 DAS 数据中的表达。 同样在本节中，我们触及了作为我们方法基础的反卷积概念。 接下来，在第三节中，我们全面描述了我们的方法，之后我们分别在第四节和第五节中展示了这些方法的定性和定量结果。 最后，我们在第六节中将这项研究的结果置于交通监控和“智能”城市的更广泛背景下。

## 二、DAS 数据中的车辆表示

为了确保充分了解我们的方法，我们首先对汽车的路边 DAS 测量进行详细展示——见图 1。光纤电缆的永久部署通常被埋入（挖沟）或放置在地下管道中，因此我们在这里假设 DAS 系统放置在路面下方某个深度的道路旁。 当汽车驶过给定的传感点时，由于车辆重量压在道路上，地下会发生变形。 这种变形被传递到光纤电缆，导致可测量幅度的应变。 当汽车处于非平稳状态时，汽车经过时应变场的变化相应地记录为应变率。  Flamant-Boussinesq 近似 [14]、[19] 很好地描述了地下某个点的这种准静态或大地测量变形：

$$ u_x(x, y, z) = \frac{ F }{ 4 \pi G } \frac{ x }{ r^2 } (\frac{ z }{ r } + \frac{ 2v - 1 }{ 1 + \frac{ z }{ r }  } ) \tag{1}$$

![](https://raw.githubusercontent.com/erbiaoger/PicGo/main/img202209110848827.png)
图 1. 路边 DAS 测量概览。  a) 汽车的重量压在地面上，引起地下（青色）的准静态变形。 当汽车行驶时，轮胎和道路之间的相互作用会导致动态变形（红色）。 埋入式光缆（黄色）能够同时感应到两者。 黑点大致表示感应点之间的距离；  b) 车辆的准静态变形易于识别，并产生相对简单的可在空间和时间上跟踪的图案；  c) 尽管其幅度高于准静态变形，但车辆的动态变形更为复杂；  d) 一个特定 DAS 通道的应变率记录（由面板 b 和 c 中的白色虚线表示)。

在这个表达式中， $u_x$是在 x 方向上的粒子位移，定义为平行于道路（和纤维），在点 (x, y, z)（y 是垂直于道路的水平距离，z 是道路下方的深度 面）相对于位于原点 p 处的点载荷的位置。 到原点的距离由 $r = \sqrt{x^2 + y^2 + z^2}$ 给出。点载荷将总力 F 施加到具有均匀剪切模量 G 和泊松比 ν 的无限半空间上. 粒子速度 $\dot u_x$ 是通过对 (1) 对时间进行微分得到的，注意 $\dot x$ 是汽车在 x 方向上行驶的速度。 因此，DAS 数据中汽车的准静态特征以汽车的速度传播，而不是以地震波的速度传播（见图 1b）。最后，DAS 系统不测量粒子运动，而是测量两个传感点之间的平均纵向应变（速率），它们之间的距离称为标距。等效 DAS 测量的表达式可以简单地找到为

$$\varepsilon_{DAS} = \frac{1}{L}[u_x (x+\frac{L}{2}, y, z) - u_x (x-\frac{L}{2}, y, z)] \tag{2a}$$
$$\dot \varepsilon_{DAS} = \frac{1}{L}[\dot u_x (x+\frac{L}{2}, y, z) - \dot u_x (x-\frac{L}{2}, y, z)] \tag{2b}$$

分别用于应变和应变率（L 表示标距长度）。 对于光纤和车辆之间的典型距离，DAS 数据中车辆的特征特征相对简单（见图 2a）。

![](https://raw.githubusercontent.com/erbiaoger/PicGo/main/img202209110848840.png)
图 2.a) 与基于方程式的模型相比，单辆汽车的测量脉冲响应（通过堆叠多个 DAS 通道获得）。  (2b)；  b) 多辆汽车沿同一方向行驶（朝向询问器)的 DAS 记录示例。 在大约 12.5 秒时，可以看到两辆车并排紧挨着，以至于它们的变形模式开始重叠

相反，汽车轮胎和道路之间的相互作用会产生表面波，这些表面波以地震速度远离震源点，分析起来相对复杂（见图 1c）。 虽然车辆引起的准静态变形主要由光纤相对于道路的距离控制，但由面波产生的动态变形模式是分散的，并且对衰减的局部变化高度敏感。 尽管如此，这些高频色散面波对于路边DAS干涉测量研究是有用的[12]-[14]。 在[18]之前对交通流的研究中，主要基于它们引起的动态变形来检测汽车。 然而，从图 1d 可以清楚地看出，准静态频带（0.1-2 Hz）中的 DAS 记录在时间上更简单且更局部化，因此在本研究中，我们专注于该频带。

尽管车辆的准静态变形模式相对简单且紧凑，但它们仍然包含有限的持续时间和空间范围（主瓣在 70 km hr-1 的速度下大约 2 s；图 2a）。 请注意，方程式。  (1) 是根据 x 参数化的，但可以使用 x = vt 代替时间 t（v 是汽车的速度）。 当两辆车紧随其后时，它们的变形模式开始重叠，可能会产生更复杂的叠加。

当 DAS 系统记录多辆汽车在相反方向行驶时，或者当一列汽车经过时，会出现其他复杂情况。 在这种情况下，简单的阈值和峰值检测技术可能很容易无法检测和分离数据集中的车辆。

这项工作中采用的方法的动机是，原则上，单辆汽车的准静态变形模式简单且易于识别。 虽然在给定的 DAS 传感点测量的特征变形模式可能会被噪声所掩盖（图 2b），但可以通过在移动记录后堆叠多个传感点的测量值来提取汽车的相对无噪声特征。 汽车的速度（图 2a）。 由于图 2a 中所示的波形代表了位于 t = 0 的单个汽车的波形，因此可以将其解释为汽车的脉冲响应。 并且由于脉冲本身在时间/空间中是无限局部的（即，车辆可以被视为点载荷），因此 DAS 数据的反卷积应该会产生一系列窄集中的峰值。 因此，期望在对去卷积数据执行分析时，可以以更高的分辨率执行车辆速度的检测和估计。

## 三、方法

### A DAS数据采集和处理

本研究中使用的 DAS 数据是在 2019 年 11 月 12 日至 28 日在法国蒙特利马尔市附近进行的为期 16 天的测量活动中获得的（图 3）。 沿着连接 Albala-Romaine、Saint-Thomé 和 Valvignères 村的主干道部署的商业电信光纤由 Febus A1-R 询问器以时间采样频率感应汽车通常在整个过程中保持恒定的速度

![](https://raw.githubusercontent.com/erbiaoger/PicGo/main/img202209110848856.png)
图 3. 光缆（蓝色）和感兴趣段（红色）的地理位置。 作为参考，道路网络以黑色显示。 电缆部署在连接所示三个村庄的主干道旁。

### B. FISTA 反卷积算法

在描述深度学习模型和训练过程之前，我们将详细介绍用作参考的传统反卷积算法。 对第 q 个传感点 $y_q$ 记录的 DAS 数据进行反卷积的任务由以下目标函数表示：  

$$\hat x_q(t) = arg_x min\{\frac{1}{2}||[k*x]_t - y_q||^2_2 + \rho ||x||_l\} \tag{3}$$
其中 $[k*x]_t$ 表示（已知）脉冲响应 k 和基础脉冲模型 x 之间的卷积，ρ 控制 x 上的 正则化的强度。包含正则化是为了承认道路上的汽车数量相对较少的概念； 最多每两秒就有一辆汽车通过一个给定的感应点。 解决此优化问题的一种常用算法是迭代收缩阈值算法（ISTA；[20]、[21]）。 在本研究中，由于 [22]，我们采用了 ISTA 的加速版本（Fast-ISTA 或 FISTA），它表现出更快的收敛保证。 这个迭代算法是在 JAX [23] 中按照算法 1 实现的：

![](https://raw.githubusercontent.com/erbiaoger/PicGo/main/img202209110848873.png)

在算法 1 中，soft(·|ρ) 表示具有阈值参数 ρ 的软阈值函数，定义为：

$$soft(x|\rho)=
\begin{cases}
x-\rho, &if\ x > \rho \\
0, &if\ |x| < \rho \\
x+\rho, &if\ x < -\rho
\end{cases} \tag {4}
$$

为了对 DAS 数据进行反卷积，我们将数据拆分为长度为每 100 秒的窗口，并针对每个时间窗口重复优化，随后将它们连接起来以产生反卷积数据集。  (F)ISTA算法的更新步长由KK|的最大特征值λmax控制。  ，其中 K 是从脉冲响应 k 构造的卷积矩阵，使得 Kx = [k ∗ x]t 。 在这项研究中，我们设置步长等于 δ = λmax /10 以确保稳定的迭代，我们根据经验选择正则化参数 ρ 为 1.5 × 10−3。


在 FISTA 方法中，每个 DAS 通道独立于其他通道进行反卷积（即，该算法是单通道反卷积过程）。 这当然不是最理想的，因为在 DAS 数据中车辆最显着的特征是它们的时空相干性（如图 2b 所示）。  因此，我们可以尝试使用深度学习方法改进这种方法。

### C. 反卷积自动编码器

1)架构：本研究采用的深度学习架构（见图 4）是轻量级 U-Net AutoEncoder [24] 的架构，它将一组 Nq = 24 个 Nt = 1024 的连续波形作为输入 ，以 Nq × Nt 矩阵组织。 输入被传递到由 3 个卷积层组成的 U-Net 自动编码器，后跟 3 个编码器块，每个编码器块具有下采样操作和 3 个卷积层。 卷积层的可学习内核大小为 3 × 5，每次下采样操作后过滤器的数量增加一倍，从 8 个过滤器开始。 最大池化操作将数据沿 DAS 传感器轴向下采样 2 倍，沿时间轴向下采样 4 倍（即，最大池化内核和步幅的大小为 2 × 4）。 在编码操作之后，潜在空间的大小为 3 × 16 × 64。解码器使用 3 个双线性上采样块来反转编码操作。  U-Net 架构的特征是存在跳跃连接，它将一个编码器块的输出直接连接到相应的（完全相反的）解码器块。 因此，在每次上采样操作之后，来自相应编码器块的输出被连接到沿特征（通道）轴的上采样数据。 连接之后是 3 个卷积层。 最后，输出层是具有 1 个输出通道和 ReLU 激活的单个卷积层，它在模型输出中强制执行正性和稀疏性。 除了输出层之外，每个卷积层后面都跟着一个 Swish 非线性 [25]，以及一个零均值和单位方差的高斯加性噪声插入层，用于进一步正则化。

将此架构转变为自监督反卷积算法的关键步骤是将模型输出 x 与沿时间轴的脉冲响应 k（图 2a）进行卷积。 因此，对于一批输入 {y1 , y2 , .  .  .  , yNb } (x, y ∈ RNq ×Nt , k ∈ R1×Nk , Nb = 128)，以下目标函数被最小化： 

$$\ell = \frac{1}{N_b}\sum^{N_b}_{i=1}(||[k*x_i]_t - y_i||^2 + \rho ||x_i||_1) \tag{5}$$

同样，[k ∗ xi ]t 表示 k 和 x 沿时间轴的卷积，并且 ρ 是控制 x 上的稀疏性的参数。 这里我们设置 ρ = 10，这似乎在稀疏性和保真度之间取得了很好的平衡。 优化这个训练目标自然会导致模型输出 x̂，它在与 k 卷积后恢复 y，从而产生反卷积算法。 因此，我们将这种深度学习方法称为反卷积自动编码器（或简称 DAE）。 另请注意，与任何自我监督方法一样，不需要基本事实或基础脉冲模型 x 的知识； 提供给模型的唯一信息是脉冲响应 k。 此外，与上一节中详述的 FISTA 算法不同，DAE 利用时空相关性来构建脉冲模型，因此可以在训练期间将车辆的时空特征（如它们的预期时差和幅度调制）合并为归纳偏差。 预计这将使 DAE 优于传统的 FISTA 方法。

2)训练程序：根据经验，我们在探索性实验中观察到，在 DAS 应变数据而非应变率数据上训练时，DAE 收敛更快且更稳健。 虽然我们没有探究其根本原因，但我们假设这可能与对称性有关：在应变中，车辆的脉冲响应是近似对称的，而在应变率中它是反对称的。 多个偏移的反对称信号的叠加会导致相消干涉，这可能会妨碍收敛。因此，我们通过频域积分将输入数据从应变率转换为应变，即数据在频域中除以 -2πn，时间频率为 n，然后转换回时域。 同样，脉冲响应被转换为应变表示（如图 4 所示）。 由于这种应变表示非常接近 Ricker 小波（也称为“墨西哥帽”），我们将经验脉冲响应替换为 Ricker 小波，它具有更有利的光谱特性，同时最小地牺牲重建保真度。

![](https://raw.githubusercontent.com/erbiaoger/PicGo/main/img202209110848892.png)
图 4. 反卷积自动编码器 (DAE) 的概念概述。  DAS 数据被送入 U-Net 自动编码器，其输出与已知的脉冲响应（沿时间轴）进行卷积以获得输入的重建。 每层卷积滤波器的数量如图所示。通过将 DAS 数据从应变率转换为应变，然后用 Ricker（“墨西哥帽子”)小波替换测量的脉冲响应，可以提高反卷积性能。

应变数据随后分为训练和验证拆分。 为了确保训练和验证数据集的统计数据相似，我们将 48 小时 DAS 数据集拆分为 50-50，以便训练和验证集都包含 24 小时交通周期（包括高峰时段）。 这些数据集被输入数据加载器，该加载器通过从每个数据集中提取随机切片来创建 128 个样本 × 24 个 DAS 通道 × 1024 个时间样本的批次。 此外，执行沿通道和时间轴的随机翻转以创建更多的数据多样性。 在每个 epoch 之后创建新的批次，并且每次都随机选择时间片。 因为随机抽样没有很好的定义一个epoch的概念，所以我们随意定义一个epoch总共包含 10,000 个样本。 然后我们对模型进行 1000 个 epoch 训练（在单个 Nvidia Quadro P4000 GPU 上花费不到 12 小时），此时训练和验证集的性能达到相同水平，表明过拟合最小（参见补充图 S1）  .该模型相对较小（只有 305,089 个可训练参数），因此它的过拟合能力很小。 增加模型的大小并没有带来更好的性能。

在测试时，验证集中的数据被分成常规的非重叠 1024 个样本切片，这些切片被馈送到模型中。 连接每个切片的模型输出 x 以创建去卷积数据集。

### D. MUSIC 波束形成和慢度校正协议

波束成形是一种常用的阵列处理技术，可估计撞击传感器阵列的各种信号的到达方向 [26]。 在地震学中，地震波束形成（和相关的反投影）用于估计到达方向和传入地震波在地震仪阵列中传播的视速度 [27]、[28]。 由于 DAS 构成单分量地震传感器的（曲线）线性阵列，因此可以进行波束成形分析 [29]，并且可以采用已建立的技术来分析移动车辆引起的振动。 在这项研究中，我们采用频域 MUSIC 波束形成 [30]，它通常表现出比（时域）延迟和和波束形成更好的分辨率，特别是对于多源 [27]。考虑一辆以有符号速度 v 行驶的单车。在给定的传感器 q 和时刻 t，第 q 个传感器记录的信号 $y_q$ 可以在频域中表示为：

$$Y_q(n) = z(n) e^{-j2\pi n \Delta t_q} + e_q(n) \tag{6}$$

其中 z 是汽车发出的信号（频率为 n）的频域表示，$e_q$ 是第 q 个传感器记录的噪声。 信号乘以指数表示由于时间延迟 Δtq 导致的相移，这又与汽车相对于传感器的位置有关。对于相隔距离 L 的等距传感器阵列，我们可以将此时间延迟表示为 $\Delta t_q = qL/v = qLs$（s 表示汽车的倒数速度或慢度）。 为了估计车辆的速度，我们将可达到的慢度值范围离散化，并将慢度分解为参考慢度 s0 和扰动 Δsi ，即 si = s0 + Δsi 。 通过将 s0 作为汽车的预期平均速度（或道路的速度限制）的倒数，这个常数项可以从方程式中扣除。  (6)，即：

$$Y_q(n) e^{j2\pi n \Delta t_q} \equiv Y'_q(n) = z(n) a_q(n) + e'_q(n) \tag{7}$$
其中 aq (n) ≡ e−2πnqLΔsi 是转向向量 a(n) 的第 q 个分量。 在时域中，yq0 现在表示 -1 根据 s0 = vref 对齐的 DAS 测量值，稍后将澄清其动机。 然后，我们通过估计协方差矩阵 C 的元素 (i, j) 来遵循标准 MUSIC 波束成形协议 [30]：

$$C_{ij} = \frac{1}{|B|}\sum_{n \in B} Y'_i \bar {Y'_j} \tag{8}$$

其中，总和在窄频带 B（此处为 0.5-2 Hz）中的所有频率 n 上延伸。 为了减少傅里叶变换中的边界效应，我们使用多锥法 [31] 估计 C。 随后获得 MUSIC 伪功率谱，作为转向向量在 C 的噪声空间上的投影的倒数，由 Nq -Ns 个最小特征向量跨越（其中 Ns 表示假定的源数；在本研究中，Ns =  2）。

为了看到执行慢速分解的优势，我们考虑如图 5a 所示的情况。 在这里，（合成）DAS 数据中存在两辆汽车，一辆以速度 +vref 离开询问器（左上到右下），另一辆以速度 -vref 向相反方向行驶。 完全包含后一种车辆所需的时间窗口持续时间为 7.5 秒。 因此，前一车辆引起的几乎所有变形都包含在此时间窗口中，这可能会干扰整体波形的相干性。 相反，在将参考慢度 s0 = -vref 分解为 -1 后，向询问器行驶的车辆（左下角到右上角）现在形成对齐波形的垂直轨迹，并且可以得到更紧凑的 4 秒时间窗口 定义仍然完全包含车辆的签名。 向另一个方向行驶的车辆大部分已经移出时间窗，因此最终MUSIC伪功率由具有负速度的车辆主导。 通过设置 s0 = +vref 获得相反的结果 -1，突出显示以正速度行驶的车辆。

我们的波束形成协议如下：我们首先从输入数据中提取参考慢度 s0 = vref，使 vref 等于 80 km hr-1 的速度限制。 请注意，输入数据可以是原始 DAS 数据，也可以是 FISTA 或 Deconvolution AutoEncoder 反卷积的数据。 然后，在原始数据的情况下，我们将 24 个 DAS 通道的波束成形窗口采用 1.6 秒，在反卷积数据的情况下采用 1.0 秒。 这些窗口大小在经验上提供了一方面时间分辨率与波束成形精度和鲁棒性之间的最佳折衷。 然后，我们以 0.2 秒的步幅在输入数据中滑动该窗口，估计每个时间窗口的 C 并计算 MUSIC 伪谱。 通过根据 s0 = -vref 移动输入数据来重复该过程 -1。每个时间窗口的算法的结果输出是离散慢度扰动 Δsi 上的光束功率分布，它被转换回速度为 -1 vi = (s0 + Δsi )。 因此，我们获得了作为（有符号）速度和时间函数的光束功率分布。

为了识别波束功率分布中的单个车辆，我们采用基本的局部峰值估计算法，将每个交通方向（正和负 vi ）获得的波束功率视为具有速度轴和时间轴的图像。 我们计算沿速度轴的最大波束功率，它给出了作为时间函数的最大波束功率。 对于这些时间序列，我们应用了 SciPy 库 [32] 中的“查找峰值”算法，要求后续峰值之间的最小距离至少为 1 秒（因为在 1 秒内很难找到两辆车尾随的可能性）  . 确定波束功率峰值的第二个标准由峰值的拓扑持久性或“突出”阈值给出，这是衡量一个峰值与其周围环境的突出程度的衡量标准。 这个阈值是一个超参数，将被调整以实现正确检测、误报和误报之间的最佳权衡。 最后，对于每个检测到的时间峰值，获得相应的速度作为沿速度轴的最大波束功率的位置。

![](https://raw.githubusercontent.com/erbiaoger/PicGo/main/img202209110848907.png)

图 5. 分解参考慢度概念的示意图。  a) 组成一辆车所需的时间窗，包括它的驶出，是 7.5 秒，还包括第二辆车在相反方向行驶引起的大部分变形；  b) 根据参考慢度变换波形后组成单辆车所需的时间窗仅为 4 s，并且不包括大部分第二辆车。

## 四、定性结果

### A. 反卷积

作为对所提出的反卷积方法的第一次验证，我们简要检查了反卷积数据的一些示例——见图 6。图 6a 显示了两辆汽车从询问器，在时间上相隔约 15 秒，这样它们引起的变形模式不会干扰。 对于 FISTA 和反卷积自动编码器方法（分别为图 6b 和 c），我们在每辆车的位置都看到了狭窄局部脉冲的尖锐脊。  DAE 在看似随机的位置显示了一些寄生峰值，由于它们的时空不相干性，这些峰值不会影响波束成形性能。  FISTA 反卷积结果显示每辆车都有一个次要的负脉冲脊，但由于这些与主脊对齐，它们在波束成形分析中将无法区分。

图 6b 显示了一个更具挑战性的例子，它的特点是一列 5 辆紧随其后的汽车。 前两辆车之间的最接近时间间隔小于 2 秒，因此该示例代表了本研究旨在解决的挑战。 与前面的示例一样，FISTA 反卷积方法会在每辆车上产生多个脉冲脊，而 DAE 会遇到一些随机定位的寄生峰值。 但是，如前所述，这些人工特征不一定会影响波束形成结果。

总体而言，FISTA 反卷积结果在时间上更加稀疏和狭窄，而 DAE 似乎产生了更稳健且易于解释的结果。 然而，使用 FISTA 处理大约 4 小时的 DAS 数据的总计算时间超过 7 分钟，而通过 DAE 传递相同数量的数据只需 1 秒多一点。 在处理大量 DAS 数据（可能是实时的）时，这 > 400 倍的加速是一个重要的考虑因素。

![](https://raw.githubusercontent.com/erbiaoger/PicGo/main/img202209110848923.png)
图 6. 所提出方法的反卷积性能示例。  a,b) 原始 DAS 数据；  c,d) 使用 FISTA 方法的去卷积数据；  e,f) 使用反卷积自动编码器的反卷积数据。



### B. 波束赋形性能：轻型交通

接下来，我们考虑波束赋形分析在轻型交通场景中的性能，使得所有车辆在空间和时间上都清晰地分开——见图 7。在第一个示例中（图 7a， 与图 6a 相同），两辆汽车沿同一方向行驶（远离询问器），而在第二个示例（图 7b）中，两辆汽车正在远离，一辆正朝着询问器行驶。 在面板 c-h 中，我们以红色表示正速度（远离询问器）和蓝色表示负速度（朝向询问器）的 MUSIC 伪功率（的对数）。

高于持久性阈值的局部峰值的估计被包括为青色圆盘。 对于这些相对简单的示例，原始数据和 FISTA 反卷积数据的检测性能良好但并不完美，原始数据集中的第二个示例注册了两个误报（图 7d），每个样本中都有一个误报检测。 去卷积数据集中的例子（图7e和f）。  DAE 反卷积数据的检测性能非常完美（没有错误或漏检）。 速度的估计在所有数据集中都是一致的，分辨率约为 ±5 km hr-1。 然而，对去卷积数据进行波束形成显然会在时间上产生更加局部化的波束功率峰值。

<img src="https://raw.githubusercontent.com/erbiaoger/PicGo/main/img202209110848947.png" style="zoom:150%;" />
图 7. 交通流量较少时波束成形性能的两个示例。 顶部面板 (a, b) 显示了在 0.1-2 Hz 通带中过滤的原始 DAS 录音。 面板中 MUSIC 伪功率的对数 (b-h) 以红色表示正速度（车辆远离询问器），蓝色表示负速度（朝向询问器)。 青色圆盘表示光束功率的局部峰值。

DAS 数据集的一个具有挑战性的方面是它同时包含个人车辆和重型卡车/卡车，后者不太常见，但在数据中表现出更高的幅度足迹。 此外，这些卡车足够重，可以产生低频面波，幸运的是，它们的振幅较低，但在数据中仍然可见。 图 8a 显示了两辆卡车在时间上分开约 10 秒的示例，第一辆卡车显然产生了相对较强的表面波（例如，在 10 秒左右的准垂直线）。 当尝试使用 FISTA 方法对这些 DAS 数据进行反卷积时（图 8c），我们看到出现了一个相对密集的脉冲模型，其时间范围甚至大于原始数据。 这显然是不可取的，当将原始数据的波束成形性能与 FISTA 反卷积数据进行比较时，我们发现反卷积数据的分辨率更差（参见图 8b 和 d）。 最后，DAE 设法产生了一个与汽车非常相似的脉冲模型，相当稀疏且定位良好（图 8e）。 然而，会产生额外的寄生脉冲脊，这会导致孤立的光束功率簇，并被峰值检测器错误地分类为单个车辆（图 8f）。

![](https://raw.githubusercontent.com/erbiaoger/PicGo/main/img202209110848990.png)
图 8. 重型卡车的反卷积和波束成形性能示例。 左图显示 a) 原始 DAS 数据，c) 使用 FISTA 方法的反卷积数据，以及 e) 使用反卷积自动编码器的反卷积数据。 每个数据集的相应 MUSIC 伪功率在右侧面板 (b, d, f) 中给出。

总结本节，在考虑原始 DAS 数据或考虑去卷积数据（使用 FISTA 或 DAE）时，在轻交通条件下的波束成形会导致类似的汽车检测性能。 在重型卡车的情况下，对去卷积数据进行波束形成会导致低分辨率检测 (FISTA) 或虚假检测（FISTA 和 DAE）。 幸运的是，可以根据卡车引起的变形幅度轻松识别卡车，因此可以在需要时以适当的方式进行处理。

### C. 波束成形性能：交通拥堵

虽然在交通拥堵条件下检测汽车的问题很容易通过标准波束成形技术解决，而无需对数据进行额外处理，但在交通繁忙条件下，当车辆紧随其后并且它们的特征开始重叠时，就会出现新的挑战—— 图 9 显示了这三个示例。在第一个示例（图 9a）中，有两辆汽车在几秒钟内相互尾随，但距离足够远，可以很容易地用肉眼分开。 在对这些数据执行波束成形时，由于波束成形窗口的大小，波束功率的峰值是重叠的（图 9d）。 因此，峰值检测器产生一些误报。 查看用 FISTA（图 9g）和 DAE（图 9j）去卷积的数据的波束成形性能，我们观察到波束功率中明显可分离的峰值，从而有助于从峰值检测算法中进行更稳健的检测。 尽管如此，仍然会为 FISTA 数据提出两个额外的错误检测。

第二个示例（图 9b；与图 6b 相同）更具挑战性，因为车辆足够接近以具有重叠的变形模式。 在这个例子中总共有 5 辆汽车，前两辆汽车（从 5 秒开始）在时间上相隔不到 2 秒。 对非去卷积数据执行波束成形，我们出人意料地恢复了 5 辆汽车中的 4 辆（图 9e），并带有额外的误报，即使波束功率集群重叠。 火车上的第一节车厢没有产生任何显着的光束功率，因此无法检测到。 对 FISTA 数据进行检测给出了完美的分数（检测到所有车辆，没有误报；图 9h），DAE 数据有一个漏检（图 9k）。

第三个也是最后一个例子（图 9c）是最具挑战性的一个。 虽然肉眼难以看清，但估计有 4 辆车从询问器驶离，随后有 4 辆车驶向询问器。 其中，标准波束形成器在每个方向上检测到 3 个（图 9f）。 对 FISTA 数据的检测也产生 3 和 3，但对于每个方向，估计至少有 1 辆车行驶非常缓慢（50 km hr-1；图 9i），这比预期的要慢得多，并且可能不准确。 最后，对 DAE 数据的检测获得了完美的分数，这得益于清晰定位的光束功率集群（图 9l）。

有人可能会争辩说，检测性能取决于拓扑持久性（或突出性）阈值，它是峰值检测算法的超参数。 较高的阈值将导致更少的波束功率峰值被分类为检测，因此可以导致更少的误报（或者相反，对于较低的阈值，更少的漏检）。这里自然需要权衡取舍，下一节将对此进行更详细的研究。 这里需要提及的是，峰值的突出程度由波束功率的“背景”水平或两个峰值之间的波束功率水平控制。 如图 9d 所示，前两辆车之间的波束功率没有完全恢复到背景水平，这是波束形成中使用的时间窗口的直接结果。 做的时候在反卷积数据上进行波束成形，可以实现更窄的时间窗，从而导致后续车辆之间的波束功率下降更明显（图 9g 和 j）。 反过来，这将允许更大的突出阈值，因为每个峰更清晰地突出，从而减少误报。
  幸运的是，执行补充分析来确定适当的突出阈值是相对简单的，这些阈值可以在误报和漏检之间进行最佳权衡。

![](https://raw.githubusercontent.com/erbiaoger/PicGo/main/img202209110848963.png)
图 9. 交通繁忙条件下波束成形性能的三个示例，按难度递增排序。 顶部面板 (a、b、c) 显示了在 0.1-2 Hz 通带中过滤的原始 DAS 录音。 面板 (b-l) 中 MUSIC 伪功率的对数以红色表示正速度（车辆远离询问器），蓝色表示负速度（朝向询问器）。 青色圆盘表示光束功率的局部峰值。

## 五、定量结果

### A. 波束功率峰值检测

对原始数据或去卷积数据执行波束功率会产生波束功率集群，需要将其转换为单个汽车的检测和速度估计。第 III-D 节中描述的波束功率峰值检测器将峰值突出度作为唯一的调整参数，这可能需要在不同的数据集之间以及在两个交通方向（远离或朝向询问器）之间变化。 对于这些案例中的每一个，我们通过比较推断的 峰和手动选择的数据集。 这个手动标记的数据集是通过标记在 1 小时的密集交通期间车辆驶向或离开询问器的时间而生成的。 在这一小时内，总共识别出 429 辆汽车，其中 332 辆远离审讯器，97 辆驶向审讯器。 为了每个来自波束功率峰值检测器的自动检测，我们在手动数据集中找到最接近的相应条目，如果两者之间的时间间隔小于 1 秒，则将其视为正确检测（真阳性；TP）。 如果自动检测和手动拾取之间的时间间隔超过 1 s，或者如果多个自动检测分配给一个手动拾取，则检测被标记为误报 (FP)。 最后，假阴性数 (FN) 只是没有相应自动检测的手动选择数，真阴性数 (TN) 是分析的时间窗口总数减去假阳性数。 在这些计算中，推断速度低于 50 km hr-1 或高于 110 km hr-1 的车辆检测被丢弃为异常值。 然后计算真阳性率（TPR；也称为召回）、假阳性率（FPR）和错误发现率（FDR）：

$$TPR = \frac{TP}{TP+FN} \tag{9a}$$

$$FPR = \frac{FP}{FP+TN} \tag{9b}$$

$$FDR = \frac{FP}{FP+TP} \tag{9b}$$

这三个量之间的最佳权衡是通过独立改变每个数据集和交通方向的峰值突出阈值来找到的，最佳值由图 10a-d 中的彩色点表示。 表 I 和图 10e 中给出了性能特征的总结。

考虑到这些性能指标，我们发现对由 DAE 去卷积的数据进行波束形成系统地优于对非去卷积数据或用 FISTA 去卷积的数据的波束形成； 在所有情况下，误报和漏检的数量较低，因此正确检测的数量较高。 由于突出阈值的校准，原始数据和去卷积数据之间的差异从真阳性（率）中并不明显； 相反，差异在假阳性和假阴性统计数据中最为明显，这显然有利于 DAE 作为检测数据中车辆的更可靠方法。

### B. 流量统计

作为对数据的最终探索，我们将我们的车辆检测方法应用于完整的验证数据集，该数据集跨越 24 小时的数据，与 DAE 反卷积。 处理1 天的 DAS 数据，DAE 用了不到 30 秒。为了使用 FISTA 对相同数量的数据进行反卷积，该算法将花费 3 多个小时（基于第 IV-A 节中引用的估计）。 随后，对去卷积数据的波束成形花费了 18 分钟以上，并在大约 2 秒内检测到波束功率的峰值。 因此，分析中的瓶颈是波束成形，但这是通过仅 0.2 秒的滑动窗口步幅完成的，以实现高分辨率可视化。 出于部署目的，可以考虑增加窗口步幅，这会按比例减少波束成形计算时间，或者并行计算而不是顺序计算。

从图 11a 所示的交通统计数据来看，白天和夜间可以通过交通量直接识别，全天比较密集，每 15 分钟可达 150 辆，而在 夜晚。 不出所料，0.1-2 Hz 频带中的 DAS 数据的标准偏差与这些统计数据密切相关。 虽然 DAS 信号方差除了一阶交通密度信息外并没有透露太多信息，但之前已经分析了地震仪噪声的变化与 COVID-19 锁定的影响有关 [33]。 因此，DAS“噪声”本身在某些应用中作为一种启发式方法可能会引起人们的兴趣，例如用于研究交通管理策略对区域范围内交通密度的影响。

有趣的是，虽然在一天中的大部分时间里，远离询问器（正向）的交通量略低于向询问器（反向）行驶的交通量，但这种平衡在清晨期间完全颠倒了（在 2019 年 11 月 21 日星期四 06:00 和 08:00），此时检测到绝大多数车辆向前行驶。 人工检查表明这不是检测伪影，而且确实可以看到更多车辆在向前行驶。 在实验过程中，DAS 询问器位于电缆北端的 Alba-la-Romaine 村（见图 3）。 因此，远离询问器的向前方向是南方向。 该地区最近的主要城市蒙特利马尔位于 Alba-la-Romaine 以东，可以通过当地的一条小路或本研究的主要道路到达。 通常，走小路的总行程时间和距离会略短。 然而，在 DAS 实验开始前几天，2019 年 11 月 11 日，在通往蒙特利马尔的路线上的 Le Teil 村附近发生了 Mw 4.9 地震（事实上，DAS 实验是快速反应的一部分） 监测余震的运动；[34]）。 由于 Le Teil 的建筑物受到广泛的结构性破坏，为了便于维修工作，通往蒙特利马尔的道路被部分封锁。 因此，许多日常通勤者和送货人员很可能选择走稍长的路线前往蒙特利马尔，以避开 Le Teil 村的交通拥堵。 从图 11b 中记录的平均速度可以推断，重定向到这条道路的额外交通不会抑制交通流量（即导致交通拥堵），因为平均速度在限速附近保持相当稳定。 只有在晚高峰时段（18:00 左右），平均速度才会出现小幅但明显的下降。

![](https://raw.githubusercontent.com/erbiaoger/PicGo/main/img202209110848977.png)
图 11 DAS 数据 24 小时流量统计。  a) 以 15 分钟间隔为每个方向的车辆计数，以及 0.1-2 Hz 频带中 DAS 数据的 15 分钟分档（标准化）标准偏差；  b) 检测到的车辆的 15 分钟分档平均值。 道路的限速如图所示。

## 六、 对智慧城市的看法

在展示了使用 DAS 分析密集交通场景的可行性之后，我们现在转向对未来发展的简要展望，特别是在“智慧城市”（sensu lato）中的应用。 光纤传感很可能对未来与固体介质相关的智慧城市的发展做出重大贡献，包括地下表征 [35]、铁路 [36] 和道路 [14] 的基础设施监测以及结构完整性评估 [2]  . 在区域范围内，光纤传感已被证明可用于记录地震 [37] 和雪崩 [38]、监测冰川 [39] 以及推断地下的水文状况 [7]。 随着暴风雨和干旱等极端天气事件在不久的将来变得更加可能[40]，密集的仪器仪表和对地下的连续观测将对农业、水、土地和森林管理、预防野火措施有用（甚至至关重要） 和边坡稳定性监测。 由于密集的光纤基础设施已经在城市 [14] 甚至农村 [19] 和海底 [41] 环境中到位，推进该领域所需的主要技术突破是那些促进高效和准确处理大量数据的技术突破。 由光纤传感产生的数据。

本研究中提出的深度学习方法同时解决了数据处理工作流程的效率和准确性。 如前几节所述，DAS 数据的反卷积提高了车辆检测方法在交通繁忙场景中的可靠性。虽然使用像 FISTA 这样的传统反卷积方法受到计算时间的阻碍，估计需要 3 多个小时来反卷积 24 小时的 DAS 数据集，但所提出的反卷积自动编码器需要不到 30 秒的时间来反卷积相同的数据集，同时产生 更高的反卷积保真度。 所提出方法的性能保证了其应用于准实时问题，其中可能包括区域交通流管理、事件或异常检测，以及交通摄像机稀缺或不存在的（农村）地区的策略测试。

即使在交通摄像机覆盖密集的城市环境中，基于 DAS 的交通监控仍然是一项宝贵的资产，因为车辆本身引起的变形模式通过停机坪的有效弹性（和粘性；[42]）特性对道路状态进行编码 . 变形模式的长期变化可能揭示道路退化，其方式类似于使用 DAS [36]、[43]、[44] 评估铁路轨道和火车车轮状况。  DAS 对该应用的可行性仍有待测试，但毫无疑问，在不久的将来还会进行更多的实验。

## 七、 结论

在这项研究中，我们考虑了路边分布式声学传感 (DAS) 的车辆检测和表征性能。 我们提出了一个程序，该程序专注于由单个车辆引起的准静态变形，由 DAS 记录为应变率的时空模式。通过随后将 MUSIC 波束成形应用于这些 DAS 数据，可以检测单个车辆并根据它们的速度进行表征，但在密集交通条件下这样做是具有挑战性的。 为了提高这种方法的时间分辨率，我们建议从 DAS 数据中对由过往车辆的重量引起的特征脉冲应变响应进行反卷积，从而提高检测的时间分辨率，以及更少的误检和漏检。出于多通道反卷积的目的，我们开发了一种自监督深度学习算法（“反卷积自动编码器”），该算法优于常用的传统反卷积算法，即快速迭代收缩阈值算法（FISTA）。  DAE 不仅可以带来更好的车辆检测性能，而且比 FISTA 快 > 400 倍，这对于在现实环境中实施我们的方法具有实际意义。

致谢 
MvdE 感谢 J.-P。  Ampuero 启发了关于反卷积方法的讨论。  DAS 询问器由 Febus 提供。 这项研究得到了法国政府通过国家研究机构 (ANR) 管理的 3IA Côte d'Azur Investments in the Future 项目的支持，参考编号 ANR-19-P3IA-0002。 深度学习在 TensorFlow 框架 [45] 中执行，通用数据操作使用 NumPy [46] 和 SciPy [32] 执行。 数据可视化是使用 Matplotlib [47] 完成的。 数据、代码和预训练模型可从 doi.org/10.6084/m9.figshare.16653163 获得。



















