# 使用卷积神经网络对大 N 地震阵列进行基于图像的自动事件检测

[TOC]

## 摘要

------

被动地震实验已被提议作为受控源地震学的一种具有成本效益和非侵入性的替代方案，允许基于地震干涉测量原理检索体波反射。 然而，从记录的大量环境噪声中，只有选定的时间段（噪声面板）对反射的检索有建设性的贡献。 我们解决了自动扫描由大 N 阵列记录的环境噪声数据的问题，以利用卷积神经网络 (CNN) 搜索体波能量（体波事件）。 它包括首先在每个接收站计算记录信号的所有划分部分（噪声面板）的幅度和频率属性值。 然后将创建的二维属性图转换为图像，并用于提取与数据中存在的体波能量相关的空间和时间模式，以构建基于二元 CNN 的分类器。 在频率和幅度属性图上分别训练的两个多头 CNN 模型的集合展示了比其每个参与网络更好的泛化能力。 我们还将我们的深度学习 (DL) 框架的预测性能与称为 XGBoost 的传统机器学习 (ML) 算法进行了比较。 基于 DL 的解决方案应用于芬兰 Kylylahti 阵列记录的 240 小时环境地震噪声数据，展示了较高的检测精度和优于基于 ML 的解决方案。 基于 CNN 的模型集合设法在完整的未标记数据集中找到几乎三倍于训练阶段提供的经过验证的体波事件。 此外，在更深的卷积层提取的高级抽象特征可用于对分类面板的视觉特征进行无监督聚类。

## 1. 介绍

对能够以对环境影响最小的情况下表征地质结构的具有成本效益的勘探技术的需求引起了人们对使用不受控源的地震成像方法的极大关注。 通过将地震干涉仪 (SI) 应用于环境噪声记录，可以在一定程度上模拟进行被动地震实验的现场的受控源地震数据 [1]。 只要波场是漫射的，环境噪声 SI (ANSI) 就允许根据它们的平均互相关从两个接收器记录的噪声中提取介质的脉冲响应，就好像它们中的一个是源一样 [2-4  ]。  SI 通过互相关作为主动源反射地震勘测的替代方法，已成功应用于从地下成像 [5-12] 到监测目的的众多研究中 [13,14]。 如果满足漫射波场的要求条件，则恢复的响应被认为代表经验格林函数（EGF），考虑了两个接收器之间介质中的面波和体波传播[15]。 通过叠加所有短时互相关()函数，可以从多重散射波中检索 EGF（CCF）在足够长的时间内 [15] 或由某些特定不受控制的源 [16] 产生的波。 后一种方法提供了一种无需进行长期数据采集的解决方案。 主要思想是选择性堆叠彼此相干的 CCF，例如，仅与体波或面波相关的 CCF，并拒绝由位于静止相区域之外的源支配的时间段 [17]。

采集技术的同步发展，例如基于微机电系统 (MEMS) [18] 或光纤分布式声学传感 (DAS) [19] 的新一代加速度计，已经降低了低功耗传感器的成本并使其成为 部署足够密集的阵列以收集没有空间混叠的高频地震数据更为可行。 然而，随着同时记录传感器（通道）数量的增长，数据量开始超过需要人工交互的技术的处理能力[20]。 大型地震数据集 [21] 数量的迅速增加需要新的策略和方法，以使处理工作流程的自动执行和减少周转时间成为可能。 对于专注于体波反射检索的环境噪声记录，可以通过**引入可以筛选大量连续数据以识别相干噪声源的算法来自动化和改进选择性堆叠方法**，这对 堆叠的 EGF。  Chamarczuk 等人已经解决了使用大 N（即大接收器数）阵列评估的包含体波能量（以下称为体波事件）的噪声记录（噪声面板）的自动检测。  [22]，他应用了支持向量机 (SVM)，一种有监督的机器学习 (ML) 算法，结合 tau-p（截取时间 - 慢度）域中的互相关波场评估和预定义的体波速度 限制。 最近，深度学习方法也被用于被动地震记录中的检测目的。 然而，它们**仅限于从 DAS 数据 [23-25] 或地震诱发的地震活动 [26-35] 中提取面波**。 其他展示的数据选择解决方案大多是半自动的和/或对预处理和交叉相关的数据执行，这反过来需要额外的操作员工作量和计算成本。 这些方法的示例基于瞬时相位相干性 [36]、统计时间序列分类 [37]、照明诊断 [38]、CCF 的不对称性 [39]、局部相似函数 [40] 或信噪比 比率（SNR）标准[41-44]。

在这项研究中，我们使用卷积神经网络 (CNN) 和 [45] 中引入的特定视觉几何组 (VGG) 构建块来开发被动地震数据中近实时体波事件检测的预测模型。 我们利用这样一个事实，**即当信号在阵列中移动时，相干信号具有某些可识别的时间和空间特征**。 这些特征可以通过在连续短时间段（噪声面板）中为整个阵列顺序计算的基本频率和幅度属性图很好地表示，并用作特征提供者，用于 CNN 算法的训练和预测目的。 一旦模型被学习，它允许在互相关操作之前根据它们的身体和表面能量图像内容对噪声面板进行快速和稳健的二元分类。 我们还表明，通过保持最后一个池化层的激活值提取的输入图像的深层特征可用于根据其视觉特征的相似性对识别的体波事件进行分组。 我们的方法经过验证的应用仅限于高密度地震勘测，但如果不是这种情况，所提出的模型创建方案仍有可能在其他环境中进行调整。 更重要的是，我们通过 Jupyter 笔记本和 GitHub 平台公开提供我们的代码，以促进我们的结果的复制（参见补充材料中的链接）。

本文的结构如下。 首先，我们介绍用于导出属性映射的数据集和信号处理技术。 然后，我们描述了模型构建过程，特别强调了 VGG 架构的实现。 随后，我们将提出的基于 CNN 的模型应用于现场数据记录，并使用在扁平属性图上训练的梯度提升分类器来对抗其性能。最后，我们展示了神经元激活的无监督聚类，并总结了所提出的基于 CNN 的方法在自动事件检测方面的有效性。

## 2. 地下多金属

作为 COGITO-MIN 项目的一部分，Kylylahti 大 N 阵列（布局见图 1a）部署在 Polvijärvi（芬兰东部）的多金属地下 Kylylahti 矿附近。 其主要目的是推进用于矿产勘探的 ANSI 成像技术的发展，并为测试新型阵列处理技术提供基准。  Kylylahti 阵列由 994 个接收站组成，其规则分布在 3.5 × 3 km 的区域内，线间距为 200 m，接收器间隔为 50 m。 地表条件从裸露的基岩到沼泽不等。 每个接收站由一个 Geospace GSR 记录器和 6 × 10-Hz 地震检波器组成，这些地震检波器尽可能聚在一起并埋藏起来，它以 2 毫秒的采样率记录大约 20 小时/天。 在这项工作中，我们分析了包含重采样到 4 ms 的 240 小时长时间序列的数据集，所有可用站点的样本总数接近 2140 亿个。 传感器采集的时间序列排列成二维数据阵列，具有时间维度（样本）和空间维度（通道）。 测量通道以线性方式从 1 到 994 编号，从轮廓 L01 中的第一个地震传感器单元开始，到轮廓 L19 中的最后一个地震传感器结束。 除了通过在线和交叉线方向上密集间隔的测量获得高分辨率成像的优势外，例如在 Kylylahti 阵列的情况下，这些数据集也可以潜在地被视为用于深度学习目的的图像，如果它们是适当的 代表。

![](https://raw.githubusercontent.com/erbiaoger/PicGo/main/img202209131554586.png)



图 1. (a) 研究区域地图。 红点和黑点是形成 Kylylahti 阵列的接收器。 为了保持每条地震测线的接收站数量相等，一些接收器（以红色表示）被跳过并且不参与属性图的计算。 红色虚线表示包围阵列的所有接收器线的轮廓（标记为 L01-L19）。 插图显示了芬兰的轮廓图和标绘区域的位置（红色方块）。  (b) 二次采样 Kylylahti 阵列的矩阵表示。 每个选定的接收站都映射到相应的小区号（以下称为接收器标识号）。 单元格的矩形形状是由每行（接收线）的重复引起的。 需要匹配列数（接收器）并保持正方形的纵横比。

为了使用 CNN 算法处理地震信号中的自动模式识别任务，需要将分析的信号从其非图像形式转换为图像帧类型数据。 虽然实现这一目标的最直接方法是在时空域中直接绘制沿地震线记录的噪声，但完成起来可能相当麻烦，尤其是对于被动地震实验，因为每个接收站数量相对较少 线，与主动勘测相比，以及暗示缺乏照亮地下或干扰因素的受控源。 在许多情况下，由于其复杂性，沿单个接收器线评估的图像模式可能不明显或不明确。 因此，从组合不相关环境噪声测量的直接视觉表示构建的训练数据集可能会导致在实践中表现不佳的有偏差的预测模型。 在这里，我们通过将单个地震轨迹特征组合到噪声面板的类似地图的表示中来解决普遍性问题。 生成的地图不仅减少了被动地震数据中包含的冗余和不相干信息，而且还为跨密集地震阵列的信号同时分析提供了一种综合方法。 首先，我们将**接收站的连续记录分割成单独的间隔（这里我们使用 10 秒长的间隔），并应用信号变换（图 2）来推导出适合填充二维数据结构的单值特征，称为 属性矩阵**。 对地震阵列中所有选定的接收器重复该过程。 为了使属性值（矩阵列）的数量与地震线（矩阵行）的数量或其数量的倍数相匹配，选择是必要的。 这样我们就得到了可以直接保存为图像的方阵，称为属性图。 在 Kylylahti 阵列的情况下，我们选择 722 个接收器（994 个）（图 1a）用于计算表示从分段地震信号中提取的频率和幅度信息的属性值（图 2）。 为了揭示频率特性，我们计算了这些碎片信号的幅度谱，然后将以下频率范围内的幅度相加：10-20、20-30 和 30-40 Hz（图 2d，g）。 对手动检测的体波事件的检查表明，它们的带宽主要与这些定义的频带重叠。 我们还测试了更窄的间隔，例如，从 10 到 50 Hz 每 5 Hz 间隔的 bin，但结果表明，相应的频率图彼此过于相似，无法在仅使用的预测模型上提供有意义的检测能力改进 三个 10 Hz 宽的间隔。

在提取本研究中使用的剩余属性之前，输入信号通过均方根 (RMS) 值进行归一化以均衡幅度。 它允许比较测量期间不同时间不同接收站记录的信号。 与频率属性类似，我们从每个 RMS 缩放信号中推导出三个幅度特征。 第一个是最大绝对值（图 2b，a），另外两个确定落在百分位数范围 0-33 和 33-66 内的信号包络的样本数（图 2c，f）。 第 66 个百分位以上的包络幅度主要对应于没有相干能量的信号，因此可以跳过该范围。 我们在分析中使用包络来更好地区分相干信号和非相干信号，分别在图 2c 中以灰色和黑色线表示。

![](https://raw.githubusercontent.com/erbiaoger/PicGo/main/202208172240953.png)图 2. 计算噪声面板中单个轨迹的属性值（定义为单个接收站的 10 秒记录段）。  (a) 未缩放的输入信号。 灰色和黑色曲线分别代表具有识别的相干波到达和随机背景噪声的信号。 以下子图使用相同的颜色约定显示。  (b) (a) 的 RMS 标定信号的绝对值。  (c) (a) 的 RMS 缩放信号的包络值。 颜色阴影对应于三个幅度范围。  (d) 幅度谱。 颜色阴影对应于三个频率范围。  (e) (b) 的最大值显示为星形标记。  (f) (c)中的样本在每个指定幅度范围内的直方图。  (g) 条形图描述了 (d) 在每个指定频率范围内求和的幅度谱。  (h) 特征矩阵，源自 (e-g)。 

在提取本研究中使用的剩余属性之前，输入信号通过均方根 (RMS) 值进行归一化以均衡幅度。 它允许比较测量期间不同时间不同接收站记录的信号。 与频率属性类似，我们从每个 RMS 缩放信号中推导出三个幅度特征。 第一个是最大绝对值（图 2b，a），另外两个确定落在百分位数范围 0-33 和 33-66 内的信号包络的样本数（图 2c，f）。 第 66 个百分位以上的包络幅度主要对应于没有相干能量的信号，因此可以跳过该范围。 我们在分析中使用包络来更好地区分相干信号和非相干信号，分别在图 2c 中以灰色和黑色线表示。  Remote Sens. 2021, 13, x 供同行评审 5 of 19 图

![](https://raw.githubusercontent.com/erbiaoger/PicGo/main/202208172307964.png)

图 3. 通过定义的属性图 (AM) 集将任意选择的具有/不具有体波能量的噪声面板转换为其图像表示。  AM 下标对应于图 2 中显示的属性值 (ATV) 推导的相同顺序。左侧的属性映射是标记训练集中的体波图像类的示例，而属性映射在 右边展示了“噪声”图像类。

## 3. 深度监督学习

在本节中，我们展示并描述了训练数据集和所采用的 CNN 架构，用于在获得的环境噪声记录图像表示中进行体波事件检测。 我们还讨论了模型构建专业

### 3.1. 训练数据集

为了构建预测模型，从随机评估的 86,000 个非重叠噪声面板中手动选择一组 1900 个训练示例。  14% 的选定面板被标记为体波，而其余的被分类为背景噪声。 每个类中不成比例的观察比率，称为类不平衡，可能通过影响分类器在训练阶段的收敛性和模型在未见数据上的泛化来对分类器产生重大影响[46]。 为了处理不平衡数据集上的 CNN 训练，我们选择了基本版本的过采样方法简单地复制少数类的样本[47]。 在这里，我们将体波类复制了七次以匹配噪声类的大小。 随后**将每个选定的面板转换为上一节中描述的六个属性图，并以 32 × 32 像素的空间分辨率保存为缩略图红-绿-黑 (RGB) 图像，以形成最终的训练集**。 近 20,000 张图像。 在图 3 中，我们展示了这两个类的一些示例。

### 3.2.  CNN架构

视觉几何组（VGG）网络是一种 CNN 架构，在 [47] 中提出并设计用 于大规模图像分类。 这与使用块（即网络中的重复结构）的想法相吻合。 作者证明，他们的模型可以应用于广泛的任务和数据集，其性能可与计算机视觉中最高效的架构（如 GoogleNet [48] 或当时不存在的 ResNet [49]）相媲美。 在这项研究中，我们从头开始开发了一个基于 VGG 概念的新模型。 我们认为它是一个明智的起点，因为它简单的架构可以很容易地实现和修改，以优化它对我们定义的检测问题的有用性。  VGG 网络架构的变化可以通过每个块中卷积层和输出通道数量的差异以及实现的块本身的数量来获得。 由于我们在比用于 VGG 模型最先进性能测试的 ImageNet 挑战数据集 [50] 中的图像小 7 倍的低分辨率图像上训练我们的模型，因此我们决定大幅降低 网络。 在可接受的时间范围内，还需要在多核中央处理器 (CPU) 集群上进行一系列计算密集型原型设计实验。 如图 4 所示，所提出的 CNN 架构包含一个大小为 32 × 32 的输入层，接收一个 3 通道 (RGB) 图像（属性图）和隐藏层，这些隐藏层被分组为三个 VGG 块，每个块定义为一组使用过滤器的卷积层 一个大小为 3 × 3 的小感受野，后跟一个最大池（下采样）层。池化在 2 × 2 像素窗口上执行，步幅为 2 [45]，以减少输入表示（例如，图像或隐藏层输出矩阵）的维数而不影响重要特征 [51]。 三个 VGG 块具有分别具有 64、128 和 256 个通道（过滤器）的卷积层，并且每个块还伴随着激活函数（这里我们使用称为 ReLU 的 Rectified Linear Unit）和随机的 dropout 正则化 在训练期间的每一步以指定的速率（此处设置为 20%）将输入神经元设置为 0，这有助于防止过度拟合 [52]。 层的深度增加对于 CNN 架构来说很常见，因为它会影响抽象的能力，并能够提取图像中更广泛的特征。 在展平最后一个 VGG 块的输出后，使用两个连续的密集层构建分类网络。 最后一个全连接线性层使用 softmax 激活函数，专为多类分类情况而设计，它返回一个得分水平向量，其总和归一化为 1。这些值可以解释为类别概率，并用于基于以下的最终分类 预先确定的阈值（例如，对于两类问题的默认值 0.5）或最大概率标准（例如，对于多类问题）。

### 3.3. 构建预测管道



为了改进训练过程，我们提出了在基于幅度和频率的属性图上分别训练的两个多头 CNN 模型的集合（图 4，分别为 AM1-AM3 和 AM4-AM6）。 它们中的每一个都是通过将三个独立的子模型（所谓的头）统一到联合训练的框架中来创建的，它们在那里合作以改善学习成果。 子模型的输入头可以被认为是使用相同类型的层但具有不同权重和初始化的网络分支。 单个子模型读取单个输入序列（即属性映射的某个子类别）并返回包含从序列中学习到的特征的摘要的平面向量（图 4，AV1-AV6）。 这些内部表示在被第一个全连接层（图 4，FCL1）解释后组合并用于在 softmax 分类层（图 4，FCL2）中进行预测。 然后通过平均将两个分类器的预测（图 4，pA 和 pF）再次组合以输出最终预测估计（图 4，pavg）。

![](https://raw.githubusercontent.com/erbiaoger/PicGo/main/img202208172328686.png)

图 4. 说明基于深度学习的解决方案模型和采用的视觉几何组 (VGG)-16 卷积神经网络 (CNN) 架构的流程图。

通过使用多个头，我们允许每个子模型在属性映射的两个主要类别（即幅度和频率导出的）内提取各种高维空间特征。 集成了两个组成模型强度的集成平均模型，当受到训练阶段看不见的图像的影响时，生成的概率估计比单个模型产生的概率估计更准确（参见第 4.2 节）。 此外，由于预测模型数量的减少（基于频率和幅度的多头模型与六个单头个体模型的混合），它可以在更短的时间内完成预测。 图 4 总结了使用在 TensorFlow [54] 库顶部运行的 Keras 神经网络库 [53] 作为其接口在 Python3 中构建的预测管道。 所提出的基于 CNN 的模型的参数配置如表 1 所示。这些参数值经过迭代调整以提高模型的泛化性。

表 1. 提出的基于 CNN 的模型的参数。

| 范围 | 值/类型 |
| :--: | :-----: |
|      |         |
|      |         |
|      |         |
|      |         |
|      |         |
|      |         |
|      |         |
|      |         |
|      |         |
|      |         |
|      |         |

## 4. 结果

在以下小节中，我们描述了用于评估和比较基于 CNN 和 ML 的模型的指标。 我们还提供了使用基于 CNN 的模型集合实现的总体预测结果的汇总统计数据，并展示了旨在对检测到的噪声面板进行分类的无监督深度嵌入式聚类的结果。

### 4.1. 指标

在二元分类问题中，任何与标记数据相关的预测都可以是正面的或负面的。  ML 算法的预测准确性通常基于观察（实际）值和预测值之间的差异来评估。 给定一组实例（即要分类的噪声面板），可以构造一个 2×2 的混淆矩阵（也称为列联表）来表示分类器做出的决定。 该矩阵的结构如表 2 所示，它是计算几个准确度指标的基础。

表 2. 二元分类问题的混淆矩阵结构。

![](https://raw.githubusercontent.com/erbiaoger/PicGo/main/img202208210906626.png)

为了测量预测分类器的整体诊断性能，我们考虑两种常用方法：F1-Score [55] 和 Precision-Recall 曲线下面积 (AUC-PR)。 后者已被报道为接收器操作特征 (ROC) 曲线的替代方案，用于不平衡分类，类别分布严重偏斜 [56]，其中正面（即体波面板）比负面更相关。 前者属于度量的单阈值类别，根据公式（1）定义为精度（2）和召回率（3）的加权调和平均值。 通常 α 取值 1 来表示准确率和召回率之间的平衡。 精度表示正确分类的相关实例（称为真阳性，在此定义为识别的体波面板）与真阳性和假阳性（被错误分类为相关的实例）之和的比例，而召回率是真阳性与 真阳性和假阴性的总和（被错误分类为不相关的实例）。 在我们的案例中，假阳性和假阴性分别由识别为体波面板的非体波面板和识别为非体波面板的体波面板表示。


$$
F_\alpha = \frac{(1+\alpha)(precision \cdot recall)}{(\alpha \cdot precision)+recall} \tag{1}
$$

$$
precision = \frac{TP}{TP+FP} \tag{2}
$$

$$
recall = \frac{TP}{TP+FN} \tag{3}
$$

F1-Score 和类似指标基于单个阈值水平（通常等于 0.5），其中高于阈值的实例被预测为正（相关），其余为负（不相关）。 与这些指标不同，AUC-PR 提供的分数被解释为所有可能阈值的整体模型性能。 虽然 PR 曲线将精度描述为召回率的函数，但 AUC 可以解释为从召回率 = 0 到召回率 = 1 的区间内的精度平均值。

### 4.2. 预测

我们通过使用在 scikit-learn 库 [57] 中实现的 k 折交叉验证 (CV)，首先在训练数据集上估计了所提出模型的性能。 这是一种常见的技术，将输入数据集随机划分为 k 个不重叠的相等子集（这里我们选择 k 的值等于 10），其中一部分用作独立的测试集，用于评估，而 其余的折叠共同用于训练模型。 这个过程重复 k 次，即直到模型没有在所有子集上训练和测试。 然后计算每次运行中记录的预测分数的平均值，并将其视为可靠的性能分数。 这里应该注意的是，虽然模型是在类平衡训练集上训练的，但为了清楚起见，验证是在类不平衡（看不见）集上执行的。 表 3 列出了 F1 和 AUC-PR 指标的平均分数。 在同一张表中，我们还报告了在与基于 CNN 的对应物相同的一组噪声面板上使用极端梯度提升算法 (XGBoost) [58] 训练的模型集合的分数，但以另一种形式表示。  XGBoost 读取的不是图像，而是一组特征向量，在我们的例子中是扁平的属性矩阵，如图 1b 所示。 我们之所以选择这种特定的 ML 算法进行比较，是因为它在非线性过程建模方面具有广泛的通用性，并且在最近的许多地震研究中报告了总体高预测效率 [59-63]。 此外，混淆矩阵对所有交叉验证折叠求和，以获得表 4 中所示的整体（累积）混淆矩阵。F1 分数和混淆矩阵都是根据设置为 0.5 的分类阈值确定的。

表 3. 当应用于相同的未见数据时，基于 CNN 和 XGBoost 的模型之间的预测性能比较。 为了评估分类器的准确性，我们使用 10 折交叉验证以及推荐用于不平衡数据的 F1 和 AUC-PR 度量分数。

![](https://raw.githubusercontent.com/erbiaoger/PicGo/main/img202208210933326.png)

表 4. 基于 CNN 和 XGBoost 的模型在交叉验证期间计算的累积混淆矩阵。

![](https://raw.githubusercontent.com/erbiaoger/PicGo/main/img202208210933204.png)

在最终的预测和评估阶段，我们使用获得的基于幅度和频率的 CNN 模型集合对由 86,000 个噪声面板组成的整个数据集进行分类。 为此，每个噪声面板都经过第 2 节中描述的图像转换过程，每次产生六张图像，然后将其作为预测模型的输入。 整体预测结果的汇总统计数据以直方图的形式呈现在图 5 中。左侧和右侧的图表显示了组合 CNN 预测的概率分布和上面检测到的体波面板的分布 概率阈值分别等于 0.8。

![img202208211332779](https://raw.githubusercontent.com/erbiaoger/PicGo/main/img202208211332779.png)

图5. (a) 由基于 CNN 的模型集合提供的所有分析噪声面板中体波出现的概率分布。  （ b ）检测到的体波事件的分布（即分配概率估计大于 0.8 的噪声面板）。

### 4.3. 深度嵌入聚类

抽动，我们对为所有预测噪声面板收集的中间 CNN 输出（激活）进行聚类。 这些值（图 4，AV1-AV6）在第一个全连接层（图 4，FCL1）之后立即提取，作为预测例程的半积。 他们通过使用后续网络层构建越来越抽象的表示来了解如何将输入（即属性映射）分解为高级特征[64]。 为了便于聚类结果的可视化和解释，我们首先使用 t 分布随机邻域嵌入方法 [65] 将 86,000 个激活集的维数从 768 维减少到 2 维，该方法测量高维空间中点之间的成对局部相似性。 尽管 t-SNE 投影是随机的并且受用户定义的困惑度参数的影响，但我们特别选择 t-SNE 是因为它广泛流行并且能够在投影中保留不同的邻域而不重叠 [66]通过这种方式，我们获得了一个低维 t-SNE 嵌入的特征空间，它可以很容易地可视化并用于推断 k-clusters 的最佳数量，这是采用 k-means 聚类算法的先决条件[67]  . 从图 6a 中可以看出，检测和验证的体波面板表示的投影样本（描绘为黄点）累积在散点图的底部，可以很容易地与其他不相关的样本（黑点）分离 . 图 6b 更仔细地查看了分配给从 k 均值聚类分析中获得的不同组的黄色点，其中预定义的 k 等于 5。我们还将从属性映射的训练示例中提取的激活值与相应的扁平化进行比较 转换为图像之前的属性矩阵（图 1b，展平之前的属性矩阵示例）。 在这两种情况下，大小为 768 和 722 的 1900 个向量批次分别使用相同的设置映射到二维 t-SNE 空间（分别为图 6c、d）。 在此基础上，生成了两个散点图，以可视化 CNN 如何在平面视图中重新排列噪声面板的属性表示

![](https://raw.githubusercontent.com/erbiaoger/PicGo/main/img202208211040982.png)

图 6. 使用 t-SNE 对高维数据进行可视化。  (a) 从 86,000 个属性图中提取的卷积特征的 t-SNE 平面表示（图 5 中表示为 AV1-AV6 的组合预测半积）。 以黄色绘制的点对应于分类为事件面板的噪声面板。  (b) 检测到的体波面板的 K 均值聚类。 每种颜色代表一个单独的类别。  (c) 用于训练 XGBoost 模型的初始特征矩阵的 t-SNE 嵌入。 数据矩阵由 1900 个未转换为图像的扁平属性图组成。  (d) 使用基于 CNN 的模型从 1900 张属性图图像中提取的深度特征矩阵的 t-SNE 嵌入。  （c，d）中的黄点描绘了相同的手动选择的体波面板示例。

 为了进一步研究预测和聚类结果，我们在图 7 中展示了被分类为发生体波事件的面板示例（在训练阶段对模型不可见）。 根据它们在 t-SNE 嵌入中的空间位置，它们被分为五个图像类（图 6b）。

对图 7 中分为五个集群的事件进行目视检查表明，预测的噪声面板基于两个主要图像特征进行分组：（i）体波事件的 SNR 比，以及（ii）虚假到达的存在 由不连贯和连贯的噪声事件表示。 这些虚假到达是与体波事件无关的事件，可分为三种类型：平面波表面波（第 1 和第 2 组）、电波（第 3 组）和影响 在检测到的体波面板（第 1-5 号集群）中，在整个时间范围（0-10 秒）内观察到多达几条痕迹。 最后一种类型的虚假到达是在所有面板中观察到的最常见的贡献，因此它可以用作集群的“质量”指标，其中集群没有。  0 包含最小数量的到达，对于序数增加的集群，这些局部噪声事件的贡献变得更加明显。 这表明所提出的聚类方法可以用作 SI 反射成像所需的体波事件的提供者，以及作为数据质量估计器

![](https://raw.githubusercontent.com/erbiaoger/PicGo/main/img202208211045603.png)

图 7. 由基于 CNN 的模型集合检测到的体波事件示例。 根据图 6b 所示的聚类结果将它们分为五个图像类别

## 5. 讨论

我们的研究表明，在手工制作的属性图上训练的 CNN 在地震事件检测案例中效果很好。 我们通过利用典型的地震属性（如轨迹振幅或频率）来生成这些地图。 虽然我们没有考虑更复杂的信号特性，但我们确实研究了在各种幅度和频率范围内获得的前一种信号的变化，或者用多个描述性统计数据（如最小值、最大值、平均值、中值和标准偏差）进行总结。 为了选择最具代表性的属性组合，我们训练了几个诊断 CNN 模型，这些模型在输入头的数量方面有所不同（即合并到更深层的 CNN 架构的侧分支），我们根据学习到的对它们进行了评估 高级功能。 鉴于 CNN 直接从原始输入中提取有意义的抽象特征，并自动将接近零的权重分配给无关的[68]，我们在两种可能的状态下检查了模型分类层之前的激活值，即体波和非体波噪声面板的预测。 我们试图保留那些导致激活值的属性，这些属性允许在状态之间进行明确区分，并排除那些无论输入如何都会产生大部分相似的低值激活的属性。 基于一系列实验测试，我们发现在图 2 所示的所选信号特征上训练的基于幅度和频率的 CNN 模型的集合提供了最佳配置。

在本研究中，我们通过实现 ResNet 架构分析了 CNN 深度对性能得分的影响。 然而，在与第 3.2 节中介绍的架构并列时，从更深层次获得的性能增益不足以接受更大复杂性的网络。 为了补充模型的比较，我们还将预测结果与 XGBoost 模型的集合包括在内，该模型在验证数据上的得分略低于基于 CNN 的对应物（表 3）。 前者检测到的标记体波面板减少了 21% 以上。 更重要的是，对剩余数据的暴露揭示了 XGBoost 集成的泛化性要差得多，这可能是由于缺乏识别数据中空间模式的能力。

在图 5a 中，我们可视化了整个未标记数据集的 CNN 预测的概率分布。 从这个总结中我们可以注意到，所有噪声面板（几乎 1000 个示例）中的 1% 被分配了大于 0.8 的概率值，我们将其视为本研究中的正分类样本。  0.5 的传统概率边界仍然是合理的，但它开始通过误报（非事件面板归类为事件面板）。 值得注意的是，仅在第一个和第 40 个面板 bin 之间的间隔选择了训练数据集（图 5b），而预测事件在第二部分更频繁，很可能与预定的主动源拍摄有关 在附近的矿场。 它证明了所提出的基于 CNN 的模型集合可以很好地推广到超出用于训练的间隔的未见数据。

深度学习开辟了一种利用在设计网络的不同层提取的高级特征用于聚类目的的新可能性，如第 4.3 节所示。 使用降维方法，当我们将非图像输入特征（图 6c）与基于 CNN 的模型学习的特征进行比较时，我们能够可视化相关类别（即体波面板）的样本是如何重组的。 图 6d)。 就实际意义而言，图 6b 和 7 中获得的集群表明，由 t-SNE 嵌入突出显示的噪声面板代表了对 SI 反射成像有用的数据，但是，由于它们与其他事件的污染程度不同，每个集群将 在应用互相关之前需要特定的预处理方法。 例如，由于无线电波和表面波的存在，专用于集群的预处理没有。 图 1-3 将要求在不同频率范围内进行带通滤波和/或滤除与污染体波能量的事件的不同时差相关的 f-k 变换的不同部分。 消除第 4.3 节中确定的、出现在图 7 所示的每个体波簇中的杂散、高幅度脉冲串可以通过迹能量归一化 [1] 轻松解决。 然而，通过单个集群内事件的相似性证明了所提出解决方案的冗余，表明预测面板的预处理可以自动化，因此我们的方法可以用作开发全自动 ML 增强环境噪声的中间步骤 成像工作流程。

##  6. 结论

我们开发了一种深度学习技术，用于在密集接收器阵列记录的海量环境噪声数据集中自动选择数据。 它旨在根据在地震网络中传播的信号的时空特征来检测和隔离以体波能量为主的时间段。 为了以适合训练卷积神经网络的图像形式提供这些可学习模式，我们对每个噪声面板进行了预处理，使得组成地震轨迹由在频域和时域中计算的六个单值属性表示。 然后将属性值排列在相应的属性矩阵中并保存为彩色缩略图（即属性图）。 在探索性数据分析期间，我们选择了近 2000 个噪声面板的训练示例，并根据它们的类别（即体波或非体波面板类）对它们进行标记。 通过使用过采样方法解决类不平衡问题，我们获得了包含近 20,000 个标记图像的最终训练数据集。 在频率和幅度属性图上分别训练的两个多头 CNN 模型的集合展示了比其每个参与网络更好的泛化能力。 为了充分受益于 CNN 学习过程，我们还表明，在更深层提取的高级抽象特征可以组合起来，并用于对分类面板的图像特征进行无监督聚类。 我们通过使用 10 折交叉验证技术检索从训练过程中阻止的噪声面板的标签来评估模型集成性能。 所提出的基于 CNN 的模型集合分别取得了 0.963 和 0.997 的出色 F1 和 AUC-PR 分数。 它还优于类似构建但使用在非图像数据（即扁平属性图）上训练的模型的 XGBoost 集成，并且当应用于完整的未标记数据集时，它设法找到几乎三倍于经过验证的体波事件 它是在培训阶段提供的。 所提出的方法不仅可以用来优化长期被动地震研究的数据选择方法，而且还可以建立一种有效的实时监测技术来揭示多个散射介质的时空变化。 它可能对一系列应用特别有价值，在这些应用中，体波的稳健检索对于估计可靠的 3-D 速度结构和跟踪其变化至关重要。 基于 CNN 的环境噪声记录中的体波检测解决方案证明了它能够识别连续数据中那些包含重建地震格林函数最有用能量的时间段。

