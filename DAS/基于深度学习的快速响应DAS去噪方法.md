## 摘要：
在大多数光纤分布式声学传感（DAS）系统中，为了获得预期的结果，DAS系统获取的传感信号通常需要去噪。 在某些应用中，例如快速移动目标的位置识别，我们需要 DAS 系统以足够的速度做出响应。 然而，如果信号在短时间内没有被充分收集（称为短时信号），大多数经典的去噪算法都不起作用。 为了在短时间内获得理想的结果，我们提出了一种基于注意力的卷积神经网络（CNN）结构，具有极短的信号窗口来学习和逼近经典去噪方法的结果。 为了评估所提出方法的有效性，该实验是在真实的现场高速公路场景下进行的，其中所需的信号被噪声淹没。 结果表明，通过使用在 100 ms 的极短时间窗口内收集的信号，现有去噪算法的处理时间不足，我们的结构产生了令人满意的去噪性能。

## I. INTRODUCTION
 基于瑞利散射 (RS) 的 DAS 为超长距离声学/振动的快速灵敏分布式测量提供了高效的解决方案，具有强大的电磁抗干扰和准确的位置识别功能。 作为DAS系统最常用的方案，相敏光时域反射计（Φ-OTDR）向光纤发射短脉冲激光，折射率略有变化。 然后通过瑞利散射（RS）使少量光返回原点。

 稿件于 2020 年 10 月 23 日收到；  2020 年 12 月 15 日修订；  2021 年 1 月 11 日接受。出版日期 2021 年 1 月 18 日； 当前版本日期 2021 年 4 月 16 日。这项工作部分得到了国家自然科学基金面上项目 51907135 的资助，部分得到中央高校基本科研业务费项目 YJ201654 的资助，部分得到四川省科技厅的资助 赠款 2020YFG0029 下的计划。  （通讯作者：彭飞） 王茂宁，四川大学计算机学院、电气工程学院，成都 610065（邮箱：wangml@scu.edu.cn）。
 邓林，四川大学综合视觉基础科学国家重点实验室，成都 610064 (e-mail: denglin@stu.scu.edu.cn)。
钟玉忠、彭飞，四川大学电机工程学院，成都 610065（邮箱：zyzc122@scu.edu.cn；pengfei@scu.edu.cn）。
张建伟，四川大学计算机学院，合成视觉基础科学国家重点实验室，成都 610065（e-mail: zhangjianwei@scu.edu.cn）。


本文中一个或多个图形的彩色版本可在 https://doi.org/10.1109/JLT.2021.3052651 获得。
Digital Object Identifier 10.1109/JLT.2021.3052651 光路长度 RS 受到任何声音/振动的调制，导致 RS 信号的相位发生变化。 然后可以对这些变化进行分布式解调，数以千计的虚拟麦克风通道实时输出声学信号。
   作为一种无处不在的技术，已广泛应用于油气管道[1]、[2]、工业和民用基础设施[3]、海底电力电缆[4]、边境等声/振动监测领域。 行 [5]。 在过去的几年中，由于DAS是一种通过光纤通信的被动监测方法，不需要用户交互，因此也出现了一些基于DAS的交通应用，包括列车定位和速度估计[6]，以及高速公路交通流量监测。 撕裂 [7]，[8]。 更重要的是，基于 DAS 的交通应用不需要额外的基础设施。 通过将DAS设备连接到现有的通信光纤，通信光纤可以充当传感器，显着降低建设成本。

许多研究一直集中在提高DAS的光学性能上，包括灵敏度、传感范围、衰落概率、空间分辨率和声信号的采样频率。 主要技术包括光放大 [9]-[11]、探测光和检测的优化调制方案 [12]-[15] 以及对所考虑事件的更高识别率 [16]-[18]。 除了上述研究之外，为了获得更好的 DAS，在实践中还应仔细考虑 DAS 中使用的光纤 [19]。 但是，直接使用现有的光缆也会带来一定的问题。 一方面，**光通信光缆不是专门为传感而设计的，其接收灵敏度与专用声传感光缆相比相对较弱**。 另一方面，**与将光纤埋在管道旁边的管道安全监控系统不同，交通道路中的通信光纤通常放置在公路槽的中间。 在这种情况下，光纤与大地之间的耦合强度不足以让DAS设备接收到声学信号，导致感应信号微弱**。 此外，**由于低频声学信号的低衰减特性，本地车辆产生的声学信号中往往夹杂着远处的低频噪声**。 因此，信号去噪是DAS技术应用于高速公路交通检测需要解决的关键问题。

已有多项研究分析了DAS信号去噪，但这些研究主要使用频域或时频域的滤波方法，包括[7]、[8]（使用小波阈值变换）和[2]（使用小波阈值变换）。 用过的多尺度小波分解，以几秒的帧窗口对 DAS 信号进行去噪）。 不幸的是，这些传统的经典去噪方法往往需要很长的处理窗口才能获得理想的结果，这使得它们不适合用于涉及快速目标跟踪的DAS应用（无法满足实时要求）。 例如，快速移动车辆的检测延迟是不可接受的。 在DAS系统与其他基础设施频繁交互的场景下，DAS系统具有快速的消息响应极为重要，这需要DAS的短时信号去噪能力。

由于 CNN 在图像去噪领域取得了显着的性能，即使以少量数据（例如像素分辨率为 100×100 的小尺寸图像）作为输入，它也能实现良好的重建性能，鼓舞人心 我们将 CNN 引入到也包含少量数据的短时 DAS 信号的去噪中。 使用 CNN 的方法可以分为两大类。 一种方法使用带有噪声的信号以及包含增强信号的先验知识的地面实况信号（也称为参考信号）来训练深度回归 CNN [20]、[21]。 这种方法将信号去噪问题视为最小化网络输出和地面真实信号之间差距的任务。 然而，提前获得地面实况信号是困难的，特别是在实际场景下。 为了克服这一挑战，Lehtinen 等人。  [22] 提出了一种称为 Noise2Noise 的 CNN，它可以从大量噪声信号中学习去噪规则，而无需参考信号。 当使用特定类型的损失函数时，可以去除相应的噪声。 但是，这仅在可以将有用信号与噪声信号区分开来时才有效。

在这项研究中，提出了一种短时信号去噪方法，使DAS系统能够满足监控系统的快速响应要求。 我们的方法采用基于注意力的具有短时间窗口的 CNN 结构来接近具有长时间窗口的经典去噪方法的优越去噪性能。 在这项研究中，分别利用 S 变换和小波变换来生成 CNN 结构中的输入-目标对并展示有效的重构。 此外，在长时间窗口内实现的任何去噪方法的性能都可以在短时间窗口内使用我们的方法进行近似。 在DAS高速公路车辆监控系统中验证了所提出方法的性能，其中使用空闲通信光纤和DAS设备收集车辆的振动信号

本文的其余部分安排如下。 第 2 节详细描述了短时信号去噪方法。 第 3 节介绍了实验结果和讨论，第 4 节介绍了一些结论性意见。

## II. METHOD
### 一、DAS系统原理

DAS系统的原理和光学配置如图1（b）所示。 不平衡的马赫-曾德尔在该 DAS 系统中使用干涉仪 (IMZI) 进行相位解调。 此外，使用声光调制器 (AOM) 调制窄线宽光纤激光器 (λ = 1550.12 nm 和 Δλ = 3 kHz)。  FPGA的通用输入/输出端口产生一个周期为0.125 ms、宽度为50 ns的脉冲序列来驱动AOM。 然后使用掺铒光纤放大器 (EDFA1) 放大探测脉冲，并使用密集波分复用 (DWDM) 滤波器（滤波器 1 100G 带宽）进行滤波，以消除放大的自发发射 (ASE) 噪声。 然后使用循环器将脉冲发射到传感光纤中。 反向散射的瑞利信号由循环器收集，然后馈送到 EDFA2 以放大微弱的瑞利反向散射光。  EDFA2 生成的 ASE 被另一个 DWDM 滤波器（滤波器 2）去除，并使用 50/50 耦合器以 10 m 的路径不平衡馈入 IMZI。 三通道光电探测器（DC-50 MHz 带宽）用于检测来自 IMZI 输出端的 3 × 3 耦合器的光。 三个采样率为 20 MSps 的 AD 转换器（12 位，最大采样率 65MSps）连接到三通道光电探测器。 将数字化传感信号发送到 FPGA 进行相位检测。 差分和跨层解调方案部署在 FPGA 中用于实时相位解调 [23]。 解调方案的输出电压与相位成线性比例。 考虑到高速公路对振动信号检测的需求和上位机的计算能力，我们对连续8个询问周期的相位进行平均。 因此，本系统的振动采样率为 1 kHz，通道间隔约为 5 m。 最后，我们可以使用DAS获得以时间（t）为水平轴，空间（s）为垂直轴，相位（φ）为强度的信号瀑布图。
![](https://raw.githubusercontent.com/erbiaoger/PicGo/main/img202209271512279.png)
图一  实验拓扑图：（a）被测光纤的位置。  (b) DAS 系统的光学设置。
![](https://raw.githubusercontent.com/erbiaoger/PicGo/main/img202209271516142.png)
图 2 不同采样时间对 S 变换的性能。
![](https://raw.githubusercontent.com/erbiaoger/PicGo/main/img202209271516168.png)
图 3 短时去噪方法的框架

在需要根据快速响应应用在短时间内对信号进行去噪的 DAS 系统中，经典去噪方法（如 S 变换和小波变换）的性能受到信号采样时间的限制。 例如，在如图 1 所示的 DAS 高速道路轨迹监测系统中。图 2 显示了输入信号长度分别为 1 s、10 s 和 1 min 的原始捕获信号及其去噪结果。 如图 2 所示，当采样时间为 1 s 或 10 秒（这足以引起时间延迟）时，大多数车辆轨迹（显示为带斜率的线）难以识别。 当采样范围达到 1 分钟时，车辆轨迹变得清晰可见。 为了在快速响应的情况下为 DAS 应用实现令人满意的去噪性能，引入了一种短信号去噪方法。 如图 3 所示，所提出的框架由振动信号捕获、训练和测试阶段组成。 采用DAS系统和空闲通信纤芯连续捕捉振动信号。 训练阶段主要包括训练数据对生成、CNN模型构建和训练。 输入数据，即原始长振动信号和目标数据，即使用基于频域滤波的方法去噪后的长信号的期望信号，被配对并分块成更小的尺寸。  CNN 模型从小块输入和目标数据对中学习去噪规则。 在测试阶段，可以使用 CNN 模型对短振动信号进行去噪，并获得理想的去噪性能。

### B. 输入-目标对生成
从信号处理的角度来看，去噪是一个滤波过程。 **经过时频变换或傅里叶变换投影后，有用信号的系数在变换域内稀疏分布，而噪声趋于白化**； 因此，去噪对于去除变换域内的噪声更有用。 变换域内的去噪本质上是一个函数逼近问题。 根据一定的准则，原始信号可以在基波扩展和平移生成的函数空间内进行最优逼近，从而将有用信号与噪声信号分离。

因此，本研究从噪声信号中获取所需信号的过程包括变换、滤波和逆变换。 变换负责将原始信号 x 投影到可以使用函数 F (·) 分离噪声和信号的域上。

$$z = F(x) \tag{1}$$

使用函数 G(·) 过滤变换域中的噪声分量。

$$\hat z = G(z) \tag{2}$$

逆变换负责通过函数 F(·) 重建所需的无噪声信号 y。

$$y =  \hat F(\hat z) \tag{3}$$

其中$F(\cdot)$和 $\hat F(\cdot)$是相反的运算符。 基于频率变换的经典去噪方法（如S变换和小波变换）的性能受到信号长度的限制，如图2所示，**本研究采用经典去噪方法处理长信号**。 接下来，**将原始信号和去噪信号（分别为 X 和 Y ）裁剪成窗口小于 1 s 的短信号，最后生成输入-目标对（Xi ，Yi ）进行训练。 考虑到DAS系统采集到的信号在空间上是相关的，将原始信号X按照空间位置进行叠加，形成二维时空信号X∈Rs×t，其中s和t代表空间的个数 通道和时间样本的数量**。 去噪信号也是如此。 输入-目标对由 (Xi, Yi) 给出。
   
C. 模型构建和训练 具有自动编码器的深度 CNN 模型的结构在重建 [20]、[22]、[24] 和分割 [25]、[26] 领域取得了显著成就。 本能地，**更深的 CNN 可以捕获更丰富和更复杂的特征，从而获得更好的性能，尽管它也需要更多的计算并且可能导致梯度消失**。 为了在计算和性能之间找到平衡，并避免这种梯度消失，在我们的重建任务中采用了 U-Net [25] 的基础架构，具有反卷积上采样和鲁棒的空间注意机制 [26]，如 如图 4 所示，它可以分为三个部分：编码器、解码器和带有注意门的跳过连接。
   
1）编码器：我们考虑使用来自较浅深度的卷积和池化层作为特征提取器，将原始单通道和大尺寸信号编码成多通道、小尺寸特征图。 我们将每层的通道数设置如下：

c = [c1,c2,c3,c4,c5] = [64, 128, 256, 512, 1024]。  (4) 

以信号 Xi ∈ Rb×1×s×t 作为网络的输入，其中 b 代表 mini-batch 大小，1 是特征通道数，编码操作可以表示为：

$$C_l = 
\begin{cases}
E_{\theta_l} (X_i) , &l = 1 \\
E_{theta_l}(S(C_{l-1})), &l > 1\\
\end{cases} \tag{5}
$$
其中 l 表示图 4 从上到下的层深度（对应时间和空间维度的下标），范围从 1 到 5。另外，Cl 是深度为 l 处的编码结果。 此外，Eθlε 是深度为 l 的 ConvEncoder 的编码函数，其中包含一系列卷积操作，然后是 ReLU 激活函数。 编码器使用 θlε 参数化。 此外，S↓l 是下采样的最大池化操作。 因为 S↓l 的输入特征图大小为 sl × tl，只有当 sl 和 tl 都可以被 2 整除时，max pooling stride 才会设置为 2，否则设置为 1。

2）跳过连接和注意门：跳过连接被广泛使用，因为它可以避免深度网络训练的梯度消失[20]，[27]，同时将深度和粗略特征与浅层和精细特征相结合[26]。 除了相应的镜像编码和解码特征矩阵之间的直接元素加法或通道连接之外，我们还利用注意力机制并将注意力门（AG）结构[26]添加到我们的网络中。

随着编码器在图 4 所示的网络架构中深入，通道中特征图的数量根据 (4) 增加。 每一层的多通道特征图不仅包含我们关注的有用信号特征，还包含不相关的噪声信号特征。  AG是一种可以自适应抑制噪声信号的结构。  AG的结构如图5所示。

![](https://raw.githubusercontent.com/erbiaoger/PicGo/main/img202209271617957.png)

图 4。所提出的 CNN 模型的整体架构。

![](https://raw.githubusercontent.com/erbiaoger/PicGo/main/img202209271618157.png)
图5. 注意门的详细结构

图5中符号Ui为上采样输出，可表示为:

$$ U_l =
\begin{cases}
S_{theta_l} (C_{l+1}), &l = 4 \\
S_{theta_l} (D_{l+1}), &l < 4 \\
\end{cases}
$$
其中 S↑θυ 是深度 l 的反卷积上采样操作，l 具有与相应的 S↓l 相同的内核大小和步幅。 它由参数 θiυ 决定，我们选择这个反卷积层作为上采样层的原因是它可以重建信号，并且比一般的上采样或反池化具有更少的信息细节损失。  Dl 是深度 l 处解码器的结果。 稍后将详细解释解码操作。

如图 5 所示，可以考虑使用两个 1 × 1 内核大小的卷积层进行线性变换，以整合通道信息并减少 Ci 和 Ui 的通道维度。 在门控中使用来自解码器的粗尺度特征提取来抑制不相关的细尺度特征和来自编码器的噪声信号通过跳过连接。 在 Conv 层的两个输出之间进行元素相加，一个 ReLU 激活函数和另一个 1×1 内核大小的卷积层，然后是 sigmoid 激活，用于生成一个单通道注意力系数掩码 与 Ul 相同的二维大小 sl × tl。 在对我们的任务有用的显着特征区域会有一个更高的系数，而在噪声特征区域这个系数会更低。 注意系数的范围是[0, 1]。  AG 的输出是 Ui 和注意系数掩码的元素乘法。 每个AG提取并融合互补信息来定义skip connection的输出，可以表示如下：

$$A_l = att_{\theta_l^\alpha} (C_l, U_l)$$

其中 attθlα 是前面描述的 AG 操作。 参数 θlα 决定了 AG 中的三个 1×1 卷积层。

3) 解码器：在获得 AG Al 的输出后，有一个连接操作用于合并来自 Ul 和 Al 的信息，为解码器提供更有针对性和更宽的通道维度特征图。 解码器操作 D 由一系列卷积操作和 ReLU 激活函数组成，可以表示如下：

$$D_l = D_{\theta_l^\delta} (concat(A_l, U_l) \tag{8}$$

其中θlδ是解码器卷积层的参数。 此外，concat 是一种根据通道维度连接两个输入的操作。 最后，我们采用另一个 1×1 卷积来整合通道信息，恢复原始的单通道维度，可以表示如下：

$$\hat Y_i = O_{\theta^o}(D_1) \tag{9}$$






