# 使用伴随方法的有限频率断层扫描使用膜表面波的方法和示例

Carl Tape, Qinya Liu and Jeroen Tromp

[TOC]

## 摘要

我们在一系列合成地震断层扫描实验中采用伴随方法来恢复南加州的表面波相速模型。我们的方法包括通过从源传播到接收器的前向波场和从接收器传播回源的“伴随”波场之间的相互作用来计算层析反演的 Fŕechet 导数。前向波场是使用 2-D 谱元法 (SEM) 和南加州的相速模型计算的。 “目标”相位速度模型用于在接收器处生成“数据”。我们指定了一个目标或失配函数，它定义了数据和合成之间失配的度量。对于给定的接收器，数据和合成之间的剩余差异是时间反转的，并用作伴随波场的源。对于每次地震，规则波场和伴随波场之间的相互作用被用来构建有限频率敏感性核，我们称之为事件核。事件内核可以被认为是特定阶段（例如 P）香蕉甜甜圈内核的加权和，权重由测量确定。总体灵敏度只是定义了失配内核的事件内核的总和。 misfit 核与嵌入在 SEM 代码中的方便的正交基函数相乘，得到 misfit 函数的梯度，即 Fr ́ echet 导数。使用非线性共轭梯度算法迭代改进模型，同时减少失配函数。我们说明了梯度的构造和最小化算法，并考虑了各种层析实验，包括源反演、结构反演和联合源结构反演。最后，我们在经典的基于 Hessian 的断层扫描和基于梯度的伴随断层扫描之间建立联系

## 1. 介绍

地震层析成像正处于从使用 1-D 参考模型的基于射线的反演到使用 3-D 参考模型的基于有限频率内核的反演的过渡状态（Aķ celik et al. 2003; Zhao et al. 2005）。从射线到基于核的反演的转变部分是由 Marquering 等人的开创性研究推动的。 （1999），赵等人。 (2000) 和 Dahlen 等人。 (2000)，它基于一维参考模型，但表明地震测量对远离射线路径的结构敏感，并受到波前愈合的影响。从 1-D 到 3-D 参考模型的转变是由计算进步以及成功模拟复杂介质中地震波传播的正向问题所推动的（例如 Komatitsch & Vilotte 1998；Komatitsch 等人 2002；Capdeville 等人。 2003）。

本文的目的是说明“3D3D”地震层析成像的方法，我们指的是基于 3-D 参考模型、完整地震波场的 3-D 数值模拟和有限频率灵敏度内核的地震层析成像。 3D-3D 断层扫描的成功很大程度上取决于两个因素。 

(1) 用于生成 3-D 合成地震图的技术的准确性和效率。 

(2) 反演算法的效率。

我们已经在并行计算机上实施了数值方法——谱元法 (SEM)，以模拟区域和全球尺度的 3-D 地震波传播（例如 Komatitsch & Tromp 1999；Komatitsch et al. 2004；Komatitsch & Tromp 2002a,b ）。

逆问题可以转换为最小化问题，其中目标或失配函数测量数据与从 3-D 模型计算的合成地震图之间的一些差异。我们解决逆问题的方法使用伴随方法（Tarantola 1984；Talagrand & Courtier 1987），它提供了失配函数的梯度，但不提供其二阶导数，即 Hessian。逆算法的效率由梯度的计算控制，每次地震只需要两次 3-D 模拟（即梯度与接收器的数量或测量的数量无关），以及有效选择的梯度方法。

使用伴随方法进行 3D-3D 层析反演的框架是在勘探地球物理学中开发的（例如 Tarantola 1984；Gauthier 等人 1986；Mora 1987；Pratt 等人 1998；Pratt 1999）。这些研究说明了梯度的计算和使用二维异构模型和二维数值算法的相关反演技术。 Bijwaard & Spakman (2000), Zhao 等人介绍了 3D-3D 断层扫描技术的应用。 （2005 年），卡普德维尔等人。 (2005) 和 Aķ celik 等人。 （2003 年）等。 Bijwaard & Spakman (2000) 通过 3-D 模型执行 3-D 射线追踪，以迭代改进全局 P 波模型。赵等人。 (2005) 使用全数值方法（有限差分）计算大洛杉矶地区 3-D 模型的走时失配函数梯度。卡德维尔等人。 (2005)，使用合成数据，展示了一种堆叠合成记录的技术，该技术将正向模拟的数量限制为每个事件（每个模型迭代）一个；但是，通常情况下，当数据集不完整时，该技术需要修改。 Ak ̧ celik 等人。 (2003) 使用合成数据，说明了使用有限元方法以及共轭梯度框架内的伴随方法的层析反演。他们还解决了反演问题的多尺度方法，以避免在反演期间达到局部最小值。

本文是 Tromp 等人的扩展。 (2005)，它将伴随方法的工作与有限频率断层扫描 (Marquering et al. 1999; Dahlen et al. 2000; Zhao et al. 2000) 和时间反转成像 (Fink et al. 1989; Fink 1992 年、1997 年）。在 Tromp 等人。 (2005) 我们说明了如何通过两个波场的相互作用来计算特定模型和特定类型测量的灵敏度内核，一个构成从源到接收器的“常规”波场，另一个构成从接收器到源传播的“伴随”波场，由接收器记录的合适的时间反演合成地震图构成。我们执行了一个简单的源反演来说明共轭梯度算法，其中只有 misfit 函数的梯度用于迭代地反演源参数。在本文中，我们使用共轭梯度方法来说明波速反演、源反演和联合（源和结构）反演。在每个示例中，为“目标”模型计算“观察到的”地震图，并根据当前模型计算合成地震图，该模型在反演过程中向目标模型迭代改进。本文中说明的所有模拟都是在单个 Linux PC 上执行的。

我们首先在最小化问题的背景下强调经典断层扫描和伴随断层扫描之间的差异。我们将经典断层扫描定义为牛顿反演方案，该方案通过构建失配函数的梯度和 Hessian 矩阵来计算每次测量的模型灵敏度（第 3 节）（例如 Woodhouse & Dziewonski 1984；Ritsema 等人 1999）。在伴随断层扫描中，仅计算梯度，并通过伴随方法计算（例如 Gauthier et al. 1986; Aķ celik et al. 2003）。在第 5 节中，我们说明了 misfit 内核的构造，它可以被认为是 misfit 函数的梯度。在第 6 节中，我们展示了如何在共轭梯度算法中使用该梯度来迭代地改进模型。最后，我们展示了几个层析实验，包括同时源结构反演，以及基于射线和核的经典反演与伴随层析成像之间的比较。 

## 2 逆问题的一般公式

我们的目标是最大限度地减少一组数据（例如波形或走时）与一组互补的合成数据之间的不匹配度。合成是基于模型 m 生成的，例如一组结构和源参数，我们的目标是通过进行（连续）模型校正 δm 来减少数据和合成之间的不匹配。我们将失配函数 χ(m) 定义为对模型 m 计算的数据和合成物之间失配的度量。函数 χ 也称为“目标”或“成本”函数。例如，χ 可以表示波形或走时差异的最小二乘测量。假设我们有一个特定的模型 m，并且我们希望获得一个更新的模型 m + δm，它使我们更接近失配函数 χ 的最小值（Nolet 1987；Tarantola 2005，附录 6.22）。我们对 χ(m + δm) 进行二次泰勒展开

$$\chi(m + \delta m) \approx \chi(m) + g(m)^T \delta m + \frac{1}{2} \delta m^T H(m) \delta m, \tag{1}$$

其中梯度向量 g ( m) 根据失配函数的一阶导数（也称为 Fr ́ echet 导数）由 

$$g(m) = \frac{\partial \chi}{\partial m} \mid_m, \tag{2}$$

和 Hessian 矩阵 H(m ) 是根据失配函数的二阶导数定义的 

$$H(m) = \frac{\partial^2 \chi}{\partial m \partial m} \mid_m, \tag{3}$$

‘|m’依赖用于强调前面的变量是在模型 m 处评估的。 (1) 相对于 δm 的梯度由 

$$g(m + \delta m) \approx g(m) + H(m) \delta m, \tag{4}$$

可以将其设置为零以获得（1）的（局部）最小值：

$$H(m) \delta m = - g(m). \tag{5}$$

更新后的模型 m + δm 可以在有或没有 Hessian H 的情况下获得。如果梯度和 Hessian（或近似 Hessian）都可用，则逆方法称为牛顿法；如果只有梯度可用，则它是一种梯度方法（例如最速下降法、共轭梯度法）。在经典的走时层析成像中，人们通常可以同时获得失配函数的梯度 g 和 Hessian H，在这种情况下，可以根据 (5) 获得模型更新 δm。对于复杂的异构模型，梯度的计算通常仍然可行，但 Hessian 的计算则不可行。在没有 Hessian 的情况下，可以仅使用基于迭代方法的梯度 (2) 来最小化失配函数。$m^{(k+1)} = m^{(k)} - \eta g(m)$

## 3 经典断层扫描

我们首先研究基于射线或有限频率灵敏度内核的二维表面波走时层析成像。这些经典的反演，包括对梯度和失配函数的 Hessian 的访问，可作为参考和标准用于仅基于梯度的后续迭代反演（第 6 节）。特别是，我们将研究需要多少次共轭梯度伴随方法的迭代才能获得与数据类似的失配，作为基于梯度和 Hessian 知识的反演。当然，我们的最终目标是使用伴随方法来解决全 3-D 参考模型的逆问题，此时 Hessian 的计算通常不可行，本文中的实验可作为实现和收敛的指南这样的迭代反演。

### 3.1 理论

走时失配函数可以表示为:

$$\chi(m) = \frac{1}{2} \sum_{i=1}^N [T_i^{obs} - T_i(m)]^2, \tag{6}$$

其中 T obs i 表示观察到的第 i 个源接收器组合的走时，T i (m) 是基于当前模型 m 的预测走时，N 是走时测量的数量。 misfit 函数 (6) 的变化由下式给出

$$\delta \chi = - \sum_{i=1}^N \Delta T_i \delta T_i, \tag{7}$$

其中 δT i 是理论走时扰动，

$$\Delta T_i = T_i^{obs} - T_i(m) \tag{8}$$

表示走时异常。走时异常的符号约定遵循 Dahlaen 等人的约定。 (2000) 和 Dahlen & Baig (2002)，因此负走时表示合成到达相对于记录到达的延迟。在整篇论文中，大写的 delta 表示差分测量，而小写的 delta 表示数学扰动。

在基于射线的层析成像中，沿第 i 条射线路径的预测走时异常 δT i 可能与基于以下关系的分数波速扰动 δ ln c = δc/c 有关

$$\delta T_i = - \int_{ray_i} c^{-1} \delta ln c \mathrm{d} s, \tag{9}$$

其中 ds 表示第 i 条射线的一段。考虑到有限频率效应，Marquering 等人。 （1999），赵等人。 (2000) 和 Dahlen 等人。 （2000）证明，走时异常可能与基于有限频率灵敏度内核 K i (x) 的相对波速扰动有关，用于第 i 个源-接收器组合

$$\delta T_i = \int_V K_i \delta ln c \mathrm{d}^3 x. \tag{10}$$

标记等。 (1999) 将这些频率有限的核称为“香蕉-甜甜圈核”，因为它们在用于互相关走时测量的光滑、球对称地球模型中的形状。这些内核也称为“灵敏度”、“有限频率”或“天生”内核。就我们的目的而言，关键是香蕉-甜甜圈内核不包含走时测量，而第 5 节中讨论的事件内核和失配内核确实包含测量

不像射线理论表达式（9），方程。 (10) 将走时异常与整个地球模型中的 3-D 异质性 δ ln c 联系起来，如通过核 K i 所见。关系 (9) 和 (10) 对任何模型都有效。通常选择一维模型，因为这使得射线和有限频率内核计算更加简单，但这不是必需的（Zhao et al. 2005）。

将 (10) 代入 (7)，我们将有限频率断层扫描的走时失配函数的变化表示为 

$$\delta \chi = \int_V K \delta ln c \mathrm{d}^3 x, \tag{11}$$


其中走时失配核 K(x) 是核 K i(x): 

$$K(x) = -\sum_{i=1}^N \Delta T_i K_i(x), \tag{12}$$

使得与核相关的第 i 个源接收器组合 K i 的权重是相应的走时异常 T i .重要的是要注意错配内核 K(x) 取决于数据的区别，而香蕉-甜甜圈内核 K i(x) 与数据无关。为了使层析反演实用，我们需要选择一组有限的基函数来扩展我们的模型。令 B k(x), k = 1, ..., M 表示一组 M 个基函数。我们将分数相速度扰动 δ ln c(x) 扩展为这些基函数： 

$$\delta ln c(x) = \sum_{k=1}^M \delta m_k B_k(x), \tag{13}$$

其中 δm k, k = 1, ... , M 表示扰动模型系数，由式（5）根据失配函数的梯度 g 和 Hessian H 确定。接下来，我们为这个经典的走时层析成像问题确定 g 和 H。将(13) 分别代入(9) 和(10)，我们得到

$$\delta T_i = \sum_{k=1}^M \delta m_k G_{ik}, \tag{14}$$

其中对于射线理论

$$G_{ik} \equiv \frac{\partial{T_i}}{\partial{m_k}} |_m = -\int_{ray_i} c^{-1} B_k \mathrm{d} s, \tag{15}$$

而对于有限频率断层扫描 

$$G_{ik} \equiv \frac{\partial{T_i}}{\partial{m_k}} |_m = \int_V K_i B_k \mathrm{d} x. \tag{16}$$

我们注意到，无论哪种情况，Gik 都取决于源-接收器几何形状（索引 i）、基函数的选择（索引 k）和参考模型的选择（m）。使用 (13) 我们将失配函数 (11) 的变化表示为 

$$\delta \chi = \sum_{k=1}^M \int_V K B_k \mathrm{x}^3 x \delta m_k. \tag{17}$$

将此结果与 

$$\delta \chi = \mathbf{g} \dot \delta \mathbf{m} = \sum_{k=1}^M g_k \delta m_k, \tag{18}$$

我们推断梯度向量 gk 的元素由 

$$g_k = \frac{\partial{\chi}}{\partial{m_k}} = \int_V K B_k \mathrm{d}^3 x, k = 1, ..., M. \tag{19}$$

这突出了失配核与失配函数梯度之间的简单关系。将 (12) 代入 (19)，我们获得

$$g_k = -\sum_{i=1}^N \int_V K_i B_k \mathrm{d^3} x \Delta T_i = -\sum_{i=1}^N G_{ik} \Delta T_i, k = 1, ..., M, \tag{20}$$

在矩阵符号中变成



















